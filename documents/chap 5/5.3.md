# Giai Ä‘oáº¡n 5: Äi sÃ¢u vÃ o cÃ¡c Thuáº­t toÃ¡n Há»c MÃ¡y Kinh Ä‘iá»ƒn
## BÃ i 5.3: Há»c dá»±a trÃªn XÃ¡c suáº¥t - Naive Bayes Classifier

### **ğŸ¯ Má»¥c tiÃªu bÃ i há»c:**
1.  Hiá»ƒu Ä‘Æ°á»£c ná»n táº£ng lÃ½ thuyáº¿t cá»§a Naive Bayes: **Äá»‹nh lÃ½ Bayes**.
2.  Náº¯m vá»¯ng giáº£ Ä‘á»‹nh "ngÃ¢y thÆ¡" (Naive) vá» sá»± **Ä‘á»™c láº­p cá»§a cÃ¡c Ä‘áº·c trÆ°ng** vÃ  Ã½ nghÄ©a cá»§a nÃ³.
3.  Biáº¿t cÃ¡c trÆ°á»ng há»£p sá»­ dá»¥ng tá»‘t nháº¥t cá»§a Naive Bayes, Ä‘áº·c biá»‡t lÃ  trong phÃ¢n loáº¡i vÄƒn báº£n.

---

### **Bá»‘i cáº£nh & Táº§m quan trá»ng**

Naive Bayes lÃ  má»™t thuáº­t toÃ¡n phÃ¢n loáº¡i dá»±a trÃªn xÃ¡c suáº¥t, láº¥y cáº£m há»©ng trá»±c tiáº¿p tá»« Äá»‹nh lÃ½ Bayes mÃ  chÃºng ta Ä‘Ã£ há»c á»Ÿ Giai Ä‘oáº¡n 2. Máº·c dÃ¹ Ä‘Æ¡n giáº£n, nÃ³ hoáº¡t Ä‘á»™ng nhanh má»™t cÃ¡ch Ä‘Ã¡ng kinh ngáº¡c vÃ  cho káº¿t quáº£ tá»‘t báº¥t ngá», Ä‘áº·c biá»‡t lÃ  vá»›i cÃ¡c bÃ i toÃ¡n liÃªn quan Ä‘áº¿n vÄƒn báº£n nhÆ° lá»c email spam hay phÃ¢n loáº¡i tÃ i liá»‡u.

Hiá»ƒu vá» Naive Bayes giÃºp báº¡n cÃ³ thÃªm má»™t cÃ´ng cá»¥ máº¡nh máº½, dá»… diá»…n giáº£i vÃ  hiá»‡u quáº£ vá» máº·t tÃ­nh toÃ¡n trong bá»™ cÃ´ng cá»¥ cá»§a mÃ¬nh.

---

### **LÃ½ thuyáº¿t Cá»‘t lÃµi & Ná»n táº£ng ToÃ¡n há»c**

#### **1. Ã”n láº¡i Äá»‹nh lÃ½ Bayes**

Má»¥c tiÃªu cá»§a chÃºng ta lÃ  tÃ­nh xÃ¡c suáº¥t Ä‘á»ƒ má»™t máº«u dá»¯ liá»‡u thuá»™c vá» má»™t lá»›p `y` nÃ o Ä‘Ã³, biáº¿t ráº±ng nÃ³ cÃ³ cÃ¡c Ä‘áº·c trÆ°ng $x_1, x_2, ..., x_n$. Tá»©c lÃ , chÃºng ta muá»‘n tÃ­nh:
$$ P(y | x_1, ..., x_n) $$

Äá»‹nh lÃ½ Bayes cho chÃºng ta má»™t cÃ¡ch Ä‘á»ƒ tÃ­nh Ä‘iá»u nÃ y:
$$ P(y | x_1, ..., x_n) = \frac{P(x_1, ..., x_n | y) \cdot P(y)}{P(x_1, ..., x_n)} $$

* $P(y)$: XÃ¡c suáº¥t tiÃªn nghiá»‡m cá»§a lá»›p `y`. (VÃ­ dá»¥: tá»· lá»‡ email spam trong toÃ n bá»™ dá»¯ liá»‡u).
* $P(x_1, ..., x_n | y)$: XÃ¡c suáº¥t tháº¥y cÃ¡c Ä‘áº·c trÆ°ng nÃ y, biáº¿t ráº±ng nÃ³ thuá»™c lá»›p `y`.
* $P(x_1, ..., x_n)$: XÃ¡c suáº¥t tháº¥y cÃ¡c Ä‘áº·c trÆ°ng nÃ y.
* $P(y | x_1, ..., x_n)$: XÃ¡c suáº¥t háº­u nghiá»‡m, lÃ  káº¿t quáº£ chÃºng ta muá»‘n tÃ¬m.

#### **2. Giáº£ Ä‘á»‹nh "NgÃ¢y thÆ¡" (The "Naive" Assumption)**

Viá»‡c tÃ­nh toÃ¡n $P(x_1, ..., x_n | y)$ lÃ  cá»±c ká»³ khÃ³ khÄƒn vÃ¬ nÃ³ Ä‘Ã²i há»i pháº£i xem xÃ©t má»‘i quan há»‡ giá»¯a táº¥t cáº£ cÃ¡c Ä‘áº·c trÆ°ng.

Äá»ƒ Ä‘Æ¡n giáº£n hÃ³a, Naive Bayes Ä‘Æ°a ra má»™t giáº£ Ä‘á»‹nh "ngÃ¢y thÆ¡" nhÆ°ng ráº¥t máº¡nh máº½: **Táº¥t cáº£ cÃ¡c Ä‘áº·c trÆ°ng Ä‘á»u Ä‘á»™c láº­p vá»›i nhau vá»›i Ä‘iá»u kiá»‡n lÃ  Ä‘Ã£ biáº¿t lá»›p `y`**.

* **Analogy:** Khi xem xÃ©t má»™t con váº­t, thuáº­t toÃ¡n giáº£ Ä‘á»‹nh ráº±ng Ä‘áº·c Ä‘iá»ƒm "cÃ³ lÃ´ng" vÃ  Ä‘áº·c Ä‘iá»ƒm "cÃ³ 4 chÃ¢n" lÃ  hai sá»± kiá»‡n hoÃ n toÃ n Ä‘á»™c láº­p, miá»…n lÃ  chÃºng ta Ä‘Ã£ biáº¿t con váº­t Ä‘Ã³ lÃ  "ChÃ³".
* **Ã nghÄ©a toÃ¡n há»c:** Giáº£ Ä‘á»‹nh nÃ y cho phÃ©p chÃºng ta chia nhá» xÃ¡c suáº¥t phá»©c táº¡p thÃ nh tÃ­ch cá»§a cÃ¡c xÃ¡c suáº¥t Ä‘Æ¡n giáº£n hÆ¡n:
    $$ P(x_1, ..., x_n | y) \approx P(x_1|y) \cdot P(x_2|y) \cdot ... \cdot P(x_n|y) $$

Viá»‡c tÃ­nh toÃ¡n cÃ¡c xÃ¡c suáº¥t riÃªng láº» nhÆ° $P(x_i|y)$ (vÃ­ dá»¥: xÃ¡c suáº¥t tá»« "khuyáº¿n mÃ£i" xuáº¥t hiá»‡n trong má»™t email spam) lÃ  ráº¥t dá»… dÃ ng báº±ng cÃ¡ch Ä‘áº¿m táº§n suáº¥t trong dá»¯ liá»‡u huáº¥n luyá»‡n.

---

### **Triá»ƒn khai & PhÃ¢n tÃ­ch Code**

ChÃºng ta sáº½ Ã¡p dá»¥ng Naive Bayes cho bÃ i toÃ¡n phÃ¢n loáº¡i vÄƒn báº£n: dá»± Ä‘oÃ¡n má»™t tin nháº¯n SMS lÃ  "spam" hay "ham" (khÃ´ng pháº£i spam).

    import pandas as pd
    from sklearn.model_selection import train_test_split
    from sklearn.feature_extraction.text import CountVectorizer
    from sklearn.naive_bayes import MultinomialNB
    from sklearn.metrics import classification_report

    # 1. Chuáº©n bá»‹ dá»¯ liá»‡u
    # Dá»¯ liá»‡u nÃ y cÃ³ thá»ƒ táº£i tá»«: https://www.kaggle.com/datasets/uciml/sms-spam-collection-dataset
    # Hoáº·c táº¡o má»™t file `sms_spam.csv` vá»›i ná»™i dung máº«u
    try:
        df = pd.read_csv('sms_spam.csv', encoding='latin-1')
        df = df[['v1', 'v2']]
        df.columns = ['label', 'message']
    
        # 2. Vector hÃ³a vÄƒn báº£n (Feature Engineering)
        # Biáº¿n Ä‘á»•i vÄƒn báº£n thÃ nh cÃ¡c vector sá»‘ Ä‘áº¿m tá»«
        vectorizer = CountVectorizer()
        X = vectorizer.fit_transform(df['message'])
        y = df['label']
    
        # 3. Chia dá»¯ liá»‡u
        X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)
    
        # 4. Huáº¥n luyá»‡n mÃ´ hÃ¬nh Multinomial Naive Bayes
        # ÄÃ¢y lÃ  biáº¿n thá»ƒ cá»§a Naive Bayes hoáº¡t Ä‘á»™ng tá»‘t vá»›i dá»¯ liá»‡u Ä‘áº¿m
        model = MultinomialNB()
        model.fit(X_train, y_train)
    
        # 5. ÄÃ¡nh giÃ¡
        y_pred = model.predict(X_test)
        
        print("--- Káº¿t quáº£ Naive Bayes cho phÃ¢n loáº¡i Spam SMS ---")
        print(classification_report(y_test, y_pred))
        
    except FileNotFoundError:
        print("Lá»—i: KhÃ´ng tÃ¬m tháº¥y file 'sms_spam.csv'.")


---

### **PhÃ¢n tÃ­ch ChuyÃªn sÃ¢u**

* **Æ¯u Ä‘iá»ƒm:**
    * Cá»±c ká»³ nhanh vÃ  hiá»‡u quáº£ vá» máº·t tÃ­nh toÃ¡n.
    * Hoáº¡t Ä‘á»™ng ráº¥t tá»‘t vá»›i cÃ¡c bá»™ dá»¯ liá»‡u cÃ³ sá»‘ chiá»u cao (nhiá»u Ä‘áº·c trÆ°ng), nhÆ° dá»¯ liá»‡u vÄƒn báº£n.
    * YÃªu cáº§u Ã­t dá»¯ liá»‡u huáº¥n luyá»‡n.
* **NhÆ°á»£c Ä‘iá»ƒm:**
    * Giáº£ Ä‘á»‹nh vá» sá»± Ä‘á»™c láº­p cá»§a cÃ¡c Ä‘áº·c trÆ°ng gáº§n nhÆ° khÃ´ng bao giá» Ä‘Ãºng trong thá»±c táº¿. Tuy nhiÃªn, thuáº­t toÃ¡n váº«n hoáº¡t Ä‘á»™ng tá»‘t má»™t cÃ¡ch Ä‘Ã¡ng ngáº¡c nhiÃªn.
    * Náº¿u má»™t háº¡ng má»¥c trong táº­p test chÆ°a tá»«ng xuáº¥t hiá»‡n trong táº­p train, nÃ³ sáº½ gÃ¡n xÃ¡c suáº¥t báº±ng 0 vÃ  lÃ m há»ng toÃ n bá»™ káº¿t quáº£ (cáº§n ká»¹ thuáº­t "lÃ m má»‹n" - smoothing).

---

### **âœï¸ BÃ i thá»±c hÃ nh:**

Sá»­ dá»¥ng bá»™ dá»¯ liá»‡u `titanic` vÃ  cÃ¡c táº­p `X_train`, `X_test` Ä‘Ã£ Ä‘Æ°á»£c tiá»n xá»­ lÃ½ (chá»‰ dÃ¹ng cÃ¡c Ä‘áº·c trÆ°ng sá»‘ Ä‘Ã£ Ä‘Æ°á»£c chuáº©n hÃ³a `StandardScaler` vÃ  cÃ¡c Ä‘áº·c trÆ°ng háº¡ng má»¥c Ä‘Ã£ Ä‘Æ°á»£c `OneHotEncoder`).

1.  **Import:** Import `GaussianNB` tá»« `sklearn.naive_bayes`. `GaussianNB` lÃ  má»™t biáº¿n thá»ƒ cá»§a Naive Bayes, giáº£ Ä‘á»‹nh ráº±ng cÃ¡c Ä‘áº·c trÆ°ng sá»‘ tuÃ¢n theo phÃ¢n phá»‘i chuáº©n (Gaussian).
2.  **Huáº¥n luyá»‡n:** Huáº¥n luyá»‡n mÃ´ hÃ¬nh `GaussianNB` trÃªn bá»™ dá»¯ liá»‡u `X_train_processed` vÃ  `y_train`.
3.  **ÄÃ¡nh giÃ¡:** ÄÆ°a ra dá»± Ä‘oÃ¡n trÃªn `X_test_processed` vÃ  in ra `classification_report`.
4.  **So sÃ¡nh:** Dá»±a trÃªn F1-score, so sÃ¡nh hiá»‡u nÄƒng cá»§a `GaussianNB` vá»›i `LogisticRegression`. MÃ´ hÃ¬nh nÃ o hoáº¡t Ä‘á»™ng tá»‘t hÆ¡n trÃªn bá»™ dá»¯ liá»‡u nÃ y?