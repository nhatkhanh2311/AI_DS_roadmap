# Giai Ä‘oáº¡n 5: Äi sÃ¢u vÃ o cÃ¡c Thuáº­t toÃ¡n Há»c MÃ¡y Kinh Ä‘iá»ƒn
## BÃ i 5.9: Há»c khÃ´ng giÃ¡m sÃ¡t (Unsupervised Learning)

### **ğŸ¯ Má»¥c tiÃªu bÃ i há»c:**
1.  Hiá»ƒu rÃµ má»¥c tiÃªu cá»§a **Há»c khÃ´ng giÃ¡m sÃ¡t**.
2.  Náº¯m vá»¯ng thuáº­t toÃ¡n phÃ¢n cá»¥m phá»• biáº¿n nháº¥t: **K-Means Clustering**.
3.  LÃ m quen vá»›i thuáº­t toÃ¡n phÃ¢n cá»¥m dá»±a trÃªn máº­t Ä‘á»™: **DBSCAN**.
4.  Hiá»ƒu láº¡i vá» **PCA** nhÆ° má»™t ká»¹ thuáº­t há»c khÃ´ng giÃ¡m sÃ¡t Ä‘á»ƒ giáº£m chiá»u dá»¯ liá»‡u.

---

### **Bá»‘i cáº£nh & Táº§m quan trá»ng**

Trong tháº¿ giá»›i thá»±c, dá»¯ liá»‡u cÃ³ nhÃ£n (nhÆ° `Survived` hay `GiÃ¡ nhÃ `) lÃ  ráº¥t hiáº¿m vÃ  Ä‘áº¯t Ä‘á» Ä‘á»ƒ thu tháº­p. NgÆ°á»£c láº¡i, dá»¯ liá»‡u khÃ´ng cÃ³ nhÃ£n thÃ¬ láº¡i vÃ´ cÃ¹ng dá»“i dÃ o.

Há»c khÃ´ng giÃ¡m sÃ¡t lÃ  má»™t bá»™ ká»¹ thuáº­t Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ tá»± Ä‘á»™ng khÃ¡m phÃ¡ cÃ¡c cáº¥u trÃºc vÃ  quy luáº­t tiá»m áº©n bÃªn trong dá»¯ liá»‡u thÃ´ mÃ  khÃ´ng cáº§n báº¥t ká»³ "cÃ¢u tráº£ lá»i Ä‘Ãºng" nÃ o cho trÆ°á»›c. NÃ³ thÆ°á»ng lÃ  bÆ°á»›c Ä‘áº§u tiÃªn trong quÃ¡ trÃ¬nh khÃ¡m phÃ¡ dá»¯ liá»‡u, giÃºp chÃºng ta hiá»ƒu hÆ¡n vá» khÃ¡ch hÃ ng, sáº£n pháº©m, hoáº·c báº¥t ká»³ há»‡ thá»‘ng phá»©c táº¡p nÃ o.

---

### **LÃ½ thuyáº¿t Cá»‘t lÃµi & Ká»¹ thuáº­t**

ChÃºng ta sáº½ táº­p trung vÃ o hai nhiá»‡m vá»¥ chÃ­nh: PhÃ¢n cá»¥m vÃ  Giáº£m chiá»u dá»¯ liá»‡u.

#### **1. PhÃ¢n cá»¥m (Clustering)**
Má»¥c tiÃªu lÃ  tá»± Ä‘á»™ng nhÃ³m cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u tÆ°Æ¡ng tá»± nhau vÃ o chung má»™t cá»¥m (cluster) vÃ  tÃ¡ch cÃ¡c Ä‘iá»ƒm khÃ´ng tÆ°Æ¡ng tá»± ra cÃ¡c cá»¥m khÃ¡c.

##### **a. K-Means Clustering**
ÄÃ¢y lÃ  thuáº­t toÃ¡n phÃ¢n cá»¥m phá»• biáº¿n nháº¥t.
* **Ã tÆ°á»Ÿng:** Báº¡n pháº£i chá»‰ Ä‘á»‹nh trÆ°á»›c sá»‘ cá»¥m (cluster) báº¡n muá»‘n tÃ¬m, gá»i lÃ  `k`.
* **Quy trÃ¬nh hoáº¡t Ä‘á»™ng (trá»±c quan):**
    1.  **Khá»Ÿi táº¡o:** Chá»n ngáº«u nhiÃªn `k` Ä‘iá»ƒm dá»¯ liá»‡u lÃ m "tÃ¢m cá»¥m" (centroids) ban Ä‘áº§u.
    2.  **GÃ¡n nhÃ£n (Assignment):** Vá»›i má»—i Ä‘iá»ƒm dá»¯ liá»‡u, tÃ­nh khoáº£ng cÃ¡ch tá»« nÃ³ Ä‘áº¿n `k` tÃ¢m cá»¥m. GÃ¡n nÃ³ vÃ o cá»¥m cá»§a tÃ¢m cá»¥m nÃ o **gáº§n nÃ³ nháº¥t**.
    3.  **Cáº­p nháº­t tÃ¢m (Update):** Sau khi Ä‘Ã£ gÃ¡n nhÃ£n cho táº¥t cáº£ cÃ¡c Ä‘iá»ƒm, tÃ­nh toÃ¡n láº¡i vá»‹ trÃ­ "tÃ¢m" thá»±c sá»± (trung bÃ¬nh cá»™ng) cá»§a táº¥t cáº£ cÃ¡c Ä‘iá»ƒm trong má»—i cá»¥m. Dá»‹ch chuyá»ƒn cÃ¡c tÃ¢m cá»¥m Ä‘áº¿n vá»‹ trÃ­ trung bÃ¬nh má»›i Ä‘Ã³.
    4.  **Láº·p láº¡i:** Láº·p láº¡i BÆ°á»›c 2 vÃ  3 cho Ä‘áº¿n khi cÃ¡c tÃ¢m cá»¥m khÃ´ng cÃ²n di chuyá»ƒn Ä‘Ã¡ng ká»ƒ ná»¯a. 

##### **b. DBSCAN (Density-Based Spatial Clustering)**
Má»™t cÃ¡ch tiáº¿p cáº­n khÃ¡c thÃ´ng minh hÆ¡n K-Means.
* **Ã tÆ°á»Ÿng:** Má»™t cá»¥m lÃ  má»™t khu vá»±c cÃ³ **máº­t Ä‘á»™** Ä‘iá»ƒm dá»¯ liá»‡u cao, Ä‘Æ°á»£c ngÄƒn cÃ¡ch vá»›i cÃ¡c cá»¥m khÃ¡c bá»Ÿi cÃ¡c khu vá»±c cÃ³ máº­t Ä‘á»™ thÆ°a thá»›t.
* **Æ¯u Ä‘iá»ƒm:**
    1.  **KhÃ´ng cáº§n chá»‰ Ä‘á»‹nh sá»‘ cá»¥m `k`** tá»« trÆ°á»›c.
    2.  CÃ³ thá»ƒ tÃ¬m tháº¥y cÃ¡c cá»¥m cÃ³ **hÃ¬nh dáº¡ng báº¥t ká»³** (khÃ´ng chá»‰ hÃ¬nh cáº§u nhÆ° K-Means).
    3.  Tá»± Ä‘á»™ng **xÃ¡c Ä‘á»‹nh cÃ¡c Ä‘iá»ƒm nhiá»…u (outliers)** (cÃ¡c Ä‘iá»ƒm khÃ´ng thuá»™c vá» cá»¥m nÃ o).

#### **2. Giáº£m chiá»u dá»¯ liá»‡u (Dimensionality Reduction): PCA**

ChÃºng ta Ä‘Ã£ gáº·p **PCA (Principal Component Analysis)** á»Ÿ BÃ i 2.4 nhÆ° má»™t á»©ng dá»¥ng cá»§a SVD. Vá» báº£n cháº¥t, nÃ³ lÃ  má»™t thuáº­t toÃ¡n há»c khÃ´ng giÃ¡m sÃ¡t.

* **Má»¥c tiÃªu:** Giáº£m sá»‘ lÆ°á»£ng Ä‘áº·c trÆ°ng (cá»™t) cá»§a bá»™ dá»¯ liá»‡u trong khi váº«n giá»¯ láº¡i nhiá»u thÃ´ng tin (phÆ°Æ¡ng sai) nháº¥t cÃ³ thá»ƒ.
* **CÃ¡ch hoáº¡t Ä‘á»™ng:** NÃ³ tÃ¬m ra cÃ¡c "trá»¥c" má»›i (gá»i lÃ  cÃ¡c thÃ nh pháº§n chÃ­nh - principal components), lÃ  tá»• há»£p tuyáº¿n tÃ­nh cá»§a cÃ¡c trá»¥c cÅ©, sao cho cÃ¡c trá»¥c má»›i nÃ y náº¯m báº¯t Ä‘Æ°á»£c nhiá»u phÆ°Æ¡ng sai nháº¥t cá»§a dá»¯ liá»‡u.
* **á»¨ng dá»¥ng:**
    1.  **Trá»±c quan hÃ³a:** Giáº£m dá»¯ liá»‡u cÃ³ 100 chiá»u xuá»‘ng cÃ²n 2 hoáº·c 3 chiá»u Ä‘á»ƒ chÃºng ta cÃ³ thá»ƒ váº½ vÃ  quan sÃ¡t cÃ¡c cá»¥m.
    2.  **NÃ©n dá»¯ liá»‡u:** Giáº£m sá»‘ lÆ°á»£ng Ä‘áº·c trÆ°ng Ä‘á»ƒ lÃ m cho cÃ¡c mÃ´ hÃ¬nh há»c mÃ¡y khÃ¡c cháº¡y nhanh hÆ¡n.

---

### **Triá»ƒn khai & PhÃ¢n tÃ­ch Code (K-Means)**

    import matplotlib.pyplot as plt
    import seaborn as sns
    from sklearn.cluster import KMeans
    from sklearn.preprocessing import StandardScaler
    from sklearn.datasets import make_blobs # Táº¡o dá»¯ liá»‡u máº«u

    # 1. Táº¡o dá»¯ liá»‡u máº«u (4 cá»¥m)
    X, y_true = make_blobs(n_samples=300, centers=4, cluster_std=0.60, random_state=0)

    # 2. Chuáº©n hÃ³a dá»¯ liá»‡u (váº«n quan trá»ng cho cÃ¡c thuáº­t toÃ¡n dá»±a trÃªn khoáº£ng cÃ¡ch)
    scaler = StandardScaler()
    X_scaled = scaler.fit_transform(X)

    # 3. Huáº¥n luyá»‡n mÃ´ hÃ¬nh K-Means
    kmeans = KMeans(n_clusters=4, random_state=42, n_init=10) # n_init=10 Ä‘á»ƒ tÄƒng Ä‘á»™ á»•n Ä‘á»‹nh
    kmeans.fit(X_scaled)

    # Láº¥y nhÃ£n cá»¥m mÃ  mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n
    y_kmeans = kmeans.predict(X_scaled)
    # Láº¥y tá»a Ä‘á»™ cÃ¡c tÃ¢m cá»¥m
    centers = kmeans.cluster_centers_

    # 4. Trá»±c quan hÃ³a káº¿t quáº£
    plt.figure(figsize=(10, 6))
    plt.scatter(X_scaled[:, 0], X_scaled[:, 1], c=y_kmeans, s=50, cmap='viridis')
    plt.scatter(centers[:, 0], centers[:, 1], c='red', s=200, alpha=0.75, marker='X', label='TÃ¢m cá»¥m')
    plt.title("Káº¿t quáº£ PhÃ¢n cá»¥m K-Means")
    plt.legend()
    plt.grid(True)
    plt.show()

---

### **âœï¸ BÃ i thá»±c hÃ nh:**

Sá»­ dá»¥ng bá»™ dá»¯ liá»‡u `titanic` Ä‘Ã£ Ä‘Æ°á»£c tiá»n xá»­ lÃ½ (`X_train_processed`, Ä‘Ã£ Ä‘Æ°á»£c chuáº©n hÃ³a vÃ  mÃ£ hÃ³a one-hot).

1.  **Ãp dá»¥ng PCA:**
    * Import `PCA` tá»« `sklearn.decomposition`.
    * Khá»Ÿi táº¡o `PCA(n_components=2, random_state=42)`. (ChÃºng ta giáº£m xuá»‘ng 2 chiá»u Ä‘á»ƒ cÃ³ thá»ƒ váº½ Ä‘á»“ thá»‹).
    * DÃ¹ng `.fit_transform()` trÃªn `X_train_processed` Ä‘á»ƒ táº¡o ra `X_train_pca` (má»™t array má»›i chá»‰ cÃ³ 2 cá»™t).

2.  **Trá»±c quan hÃ³a cÃ¡c Lá»›p:**
    * Táº¡o má»™t biá»ƒu Ä‘á»“ **scatter plot** cá»§a `X_train_pca`.
    * Trá»¥c `x` lÃ  thÃ nh pháº§n chÃ­nh thá»© nháº¥t (cá»™t 0 cá»§a `X_train_pca`).
    * Trá»¥c `y` lÃ  thÃ nh pháº§n chÃ­nh thá»© hai (cá»™t 1 cá»§a `X_train_pca`).
    * Quan trá»ng: TÃ´ mÃ u (`c=`) cÃ¡c Ä‘iá»ƒm dá»¯ liá»‡u báº±ng nhÃ£n tháº­t (`y_train`).
    * **CÃ¢u há»i:** Dá»±a trÃªn biá»ƒu Ä‘á»“, báº¡n cÃ³ tháº¥y cÃ¡c Ä‘iá»ƒm "Sá»‘ng sÃ³t" (lá»›p 1) vÃ  "Tá»­ vong" (lá»›p 0) cÃ³ xu hÆ°á»›ng tÃ¡ch biá»‡t nhau trong khÃ´ng gian 2 chiá»u má»›i nÃ y khÃ´ng? Äiá»u nÃ y cho chÃºng ta biáº¿t Ä‘iá»u gÃ¬?

3.  **Ãp dá»¥ng K-Means:**
    * Huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh `KMeans` vá»›i `n_clusters=2` trÃªn `X_train_pca`.
    * Láº¥y nhÃ£n dá»± Ä‘oÃ¡n (`kmeans.predict()`) vÃ  so sÃ¡nh chÃºng vá»›i nhÃ£n tháº­t (`y_train`). (LÆ°u Ã½: nhÃ£n `0` cá»§a KMeans cÃ³ thá»ƒ tÆ°Æ¡ng á»©ng vá»›i nhÃ£n `1` cá»§a `y_train` vÃ  ngÆ°á»£c láº¡i, nÃªn báº¡n cÃ³ thá»ƒ cáº§n pháº£i so sÃ¡nh ma tráº­n nháº§m láº«n).