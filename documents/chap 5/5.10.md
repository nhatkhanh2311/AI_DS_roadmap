# Giai Ä‘oáº¡n 5: Äi sÃ¢u vÃ o cÃ¡c Thuáº­t toÃ¡n Há»c MÃ¡y Kinh Ä‘iá»ƒn
## BÃ i 5.10: Tá»‘i Æ°u hÃ³a Láº¥y cáº£m há»©ng tá»« Tá»± nhiÃªn - Thuáº­t toÃ¡n Di truyá»n (GA)

### **ğŸ¯ Má»¥c tiÃªu bÃ i há»c:**
1.  Hiá»ƒu tÆ° duy cá»‘t lÃµi cá»§a **Thuáº­t toÃ¡n Di truyá»n (Genetic Algorithm)** dá»±a trÃªn quÃ¡ trÃ¬nh chá»n lá»c tá»± nhiÃªn.
2.  Náº¯m vá»¯ng 5 bÆ°á»›c cá»§a quy trÃ¬nh tiáº¿n hÃ³a: Khá»Ÿi táº¡o, ÄÃ¡nh giÃ¡, Chá»n lá»c, Lai ghÃ©p, vÃ  Äá»™t biáº¿n.
3.  Hiá»ƒu rÃµ khÃ¡i niá»‡m **tá»‘i Æ°u hÃ³a phi Ä‘áº¡o hÃ m (gradient-free optimization)** vÃ  táº¡i sao nÃ³ quan trá»ng.

---

### **Bá»‘i cáº£nh & Táº§m quan trá»ng**

Cho Ä‘áº¿n nay, phÆ°Æ¡ng phÃ¡p tá»‘i Æ°u hÃ³a chÃ­nh mÃ  chÃºng ta biáº¿t lÃ  **Gradient Descent**. NÃ³ hoáº¡t Ä‘á»™ng tuyá»‡t vá»i, nhÆ°ng cÃ³ má»™t yÃªu cáº§u báº¯t buá»™c: hÃ m máº¥t mÃ¡t pháº£i "mÆ°á»£t" vÃ  cÃ³ thá»ƒ tÃ­nh Ä‘Æ°á»£c Ä‘áº¡o hÃ m (Ä‘á»ƒ chÃºng ta biáº¿t "hÆ°á»›ng dá»‘c" mÃ  Ä‘i xuá»‘ng).

NhÆ°ng Ä‘iá»u gÃ¬ sáº½ xáº£y ra náº¿u bÃ i toÃ¡n tá»‘i Æ°u hÃ³a cá»§a chÃºng ta:
* KhÃ´ng cÃ³ Ä‘áº¡o hÃ m (vÃ­ dá»¥: tá»‘i Æ°u hÃ³a sá»‘ lÆ°á»£ng cÃ¢y trong Random Forest)?
* CÃ³ quÃ¡ nhiá»u "Ä‘Ã¡y thung lÅ©ng" (cá»±c tiá»ƒu cá»¥c bá»™) mÃ  Gradient Descent cÃ³ thá»ƒ bá»‹ máº¯c káº¹t?

Thuáº­t toÃ¡n Di truyá»n (GA) ra Ä‘á»i Ä‘á»ƒ giáº£i quyáº¿t nhá»¯ng váº¥n Ä‘á» nÃ y. NÃ³ lÃ  má»™t thuáº­t toÃ¡n **tá»‘i Æ°u hÃ³a phi Ä‘áº¡o hÃ m** (gradient-free), mÃ´ phá»ng láº¡i quÃ¡ trÃ¬nh tiáº¿n hÃ³a vÃ  chá»n lá»c tá»± nhiÃªn cá»§a Darwin.

**Analogy:** Náº¿u Gradient Descent lÃ  má»™t ngÆ°á»i leo nÃºi Ä‘Æ¡n Ä‘á»™c, cáº©n tháº­n Ä‘i xuá»‘ng dá»‘c, thÃ¬ Thuáº­t toÃ¡n Di truyá»n giá»‘ng nhÆ° tháº£ 100 ngÆ°á»i lÃ­nh dÃ¹ xuá»‘ng ngá»n nÃºi, Ä‘á»ƒ há» tá»± sinh tá»“n, nhá»¯ng ngÆ°á»i khá»e nháº¥t sáº½ sinh con, vÃ  qua nhiá»u tháº¿ há»‡, con chÃ¡u cá»§a há» sáº½ táº­p trung táº¡i Ä‘iá»ƒm tháº¥p nháº¥t.

---

### **LÃ½ thuyáº¿t Cá»‘t lÃµi: 5 bÆ°á»›c cá»§a Thuáº­t toÃ¡n Tiáº¿n hÃ³a**

GA lÃ m viá»‡c vá»›i má»™t "quáº§n thá»ƒ" (population) gá»“m nhiá»u "cÃ¡ thá»ƒ" (individuals). Má»—i cÃ¡ thá»ƒ lÃ  má»™t **giáº£i phÃ¡p á»©ng cá»­ viÃªn** cho bÃ i toÃ¡n.

#### **1. Khá»Ÿi táº¡o (Initialization)**
Táº¡o ra má»™t quáº§n thá»ƒ ban Ä‘áº§u (vÃ­ dá»¥: 100 cÃ¡ thá»ƒ) má»™t cÃ¡ch ngáº«u nhiÃªn. Má»—i cÃ¡ thá»ƒ lÃ  má»™t bá»™ tham sá»‘ $\theta$ ngáº«u nhiÃªn.

#### **2. ÄÃ¡nh giÃ¡ Äá»™ thÃ­ch nghi (Fitness Evaluation)**
ÄÃ¡nh giÃ¡ "sá»©c khá»e" cá»§a tá»«ng cÃ¡ thá»ƒ báº±ng má»™t **hÃ m thÃ­ch nghi (fitness function)**. Trong há»c mÃ¡y, hÃ m nÃ y thÆ°á»ng lÃ  **nghá»‹ch Ä‘áº£o cá»§a hÃ m máº¥t mÃ¡t** (vÃ­ dá»¥: 1/MSE, vÃ¬ chÃºng ta muá»‘n tá»‘i Ä‘a hÃ³a sá»± thÃ­ch nghi). CÃ¡ thá»ƒ nÃ o cÃ³ lá»—i tháº¥p nháº¥t sáº½ cÃ³ Ä‘á»™ thÃ­ch nghi cao nháº¥t.

#### **3. Chá»n lá»c (Selection)**
Chá»n ra nhá»¯ng cÃ¡ thá»ƒ "khá»e máº¡nh nháº¥t" (cÃ³ Ä‘á»™ thÃ­ch nghi cao nháº¥t) Ä‘á»ƒ lÃ m "cha máº¹" cho tháº¿ há»‡ tiáº¿p theo. Nhá»¯ng cÃ¡ thá»ƒ yáº¿u sáº½ bá»‹ loáº¡i bá».

#### **4. Lai ghÃ©p (Crossover)**
Táº¡o ra "con cÃ¡i" (tháº¿ há»‡ má»›i) báº±ng cÃ¡ch káº¿t há»£p "gen" (cÃ¡c pháº§n cá»§a giáº£i phÃ¡p) tá»« hai "cha máº¹" Ä‘Ã£ Ä‘Æ°á»£c chá»n lá»c. VÃ­ dá»¥, láº¥y ná»­a Ä‘áº§u tham sá»‘ tá»« cha vÃ  ná»­a sau tá»« máº¹. Má»¥c Ä‘Ã­ch lÃ  Ä‘á»ƒ káº¿t há»£p nhá»¯ng Ä‘áº·c Ä‘iá»ƒm tá»‘t cá»§a cÃ¡c giáº£i phÃ¡p tá»‘t.

#### **5. Äá»™t biáº¿n (Mutation)**
Thay Ä‘á»•i ngáº«u nhiÃªn má»™t vÃ i "gen" cá»§a con cÃ¡i (vÃ­ dá»¥: thay Ä‘á»•i ngáº«u nhiÃªn má»™t vÃ i giÃ¡ trá»‹ tham sá»‘). Má»¥c Ä‘Ã­ch lÃ  Ä‘á»ƒ duy trÃ¬ sá»± Ä‘a dáº¡ng trong quáº§n thá»ƒ vÃ  giÃºp thuáº­t toÃ¡n **thoÃ¡t khá»i cÃ¡c cá»±c tiá»ƒu cá»¥c bá»™**.

Sau Ä‘Ã³, quáº§n thá»ƒ má»›i nÃ y sáº½ thay tháº¿ quáº§n thá»ƒ cÅ©, vÃ  toÃ n bá»™ quy trÃ¬nh (BÆ°á»›c 2 Ä‘áº¿n 5) Ä‘Æ°á»£c láº·p láº¡i qua nhiá»u tháº¿ há»‡, cho Ä‘áº¿n khi chÃºng ta tÃ¬m tháº¥y má»™t giáº£i phÃ¡p Ä‘á»§ tá»‘t.

---

### **PhÃ¢n tÃ­ch ChuyÃªn sÃ¢u**

* **Gradient-Free:** Lá»£i tháº¿ lá»›n nháº¥t lÃ  GA khÃ´ng cáº§n báº¥t ká»³ thÃ´ng tin nÃ o vá» Ä‘áº¡o hÃ m. NÃ³ chá»‰ cáº§n biáº¿t má»™t giáº£i phÃ¡p "tá»‘t" hay "tá»‡" thÃ´ng qua hÃ m thÃ­ch nghi.
* **TÃ¬m kiáº¿m ToÃ n cá»¥c (Global Search):** Nhá» vÃ o tÃ­nh ngáº«u nhiÃªn cá»§a Äá»™t biáº¿n, GA cÃ³ kháº£ nÄƒng "nháº£y" ra khá»i cÃ¡c cá»±c tiá»ƒu cá»¥c bá»™ Ä‘á»ƒ tÃ¬m kiáº¿m cá»±c tiá»ƒu toÃ n cá»¥c tá»‘t hÆ¡n (Ä‘iá»u mÃ  Gradient Descent thÆ°á»ng xuyÃªn tháº¥t báº¡i).

* **So sÃ¡nh GA vÃ  Gradient Descent:**

| TiÃªu chÃ­          | Gradient Descent                       | Thuáº­t toÃ¡n Di truyá»n (GA)                         |
|:------------------|:---------------------------------------|:--------------------------------------------------|
| **YÃªu cáº§u**       | HÃ m máº¥t mÃ¡t pháº£i liÃªn tá»¥c, cÃ³ Ä‘áº¡o hÃ m. | Chá»‰ cáº§n má»™t hÃ m Ä‘Ã¡nh giÃ¡ (fitness).               |
| **CÃ¡ch tÃ¬m kiáº¿m** | Cá»¥c bá»™ (Local) - Ä‘i theo Ä‘á»™ dá»‘c.       | ToÃ n cá»¥c (Global) - tÃ¬m kiáº¿m song song nhiá»u nÆ¡i. |
| **Káº¿t quáº£**       | Há»™i tá»¥ vá» má»™t cá»±c tiá»ƒu cá»¥c bá»™.         | CÃ³ kháº£ nÄƒng tÃ¬m ra cá»±c tiá»ƒu toÃ n cá»¥c.             |
| **Chi phÃ­**       | TÆ°Æ¡ng Ä‘á»‘i nhanh.                       | Ráº¥t tá»‘n kÃ©m (pháº£i Ä‘Ã¡nh giÃ¡ cáº£ má»™t quáº§n thá»ƒ).      |

---

### **Triá»ƒn khai & PhÃ¢n tÃ­ch Code**

Viáº¿t má»™t thuáº­t toÃ¡n GA tá»« Ä‘áº§u khÃ¡ phá»©c táº¡p, nhÆ°ng chÃºng ta cÃ³ thá»ƒ sá»­ dá»¥ng cÃ¡c thÆ° viá»‡n nhÆ° `geneticalgorithm`.

    # Báº¡n cáº§n cÃ i Ä‘áº·t thÆ° viá»‡n: pip install geneticalgorithm
    from geneticalgorithm import geneticalgorithm as ga
    import numpy as np

    def complex_function(X):
        """HÃ m sá»‘ phá»©c táº¡p cÃ³ nhiá»u cá»±c tiá»ƒu cá»¥c bá»™."""
        # ÄÃ¢y lÃ  hÃ m chÃºng ta muá»‘n tÃ¬m giÃ¡ trá»‹ nhá» nháº¥t (minimum)
        return np.sum(X**2 + 10*np.sin(X))

    # Äá»‹nh nghÄ©a "biÃªn" (boundaries) cho cÃ¡c biáº¿n cá»§a chÃºng ta.
    # Giáº£ sá»­ chÃºng ta tÃ¬m 3 biáº¿n (3 chiá»u), má»—i biáº¿n trong khoáº£ng [-10, 10]
    varbound = np.array([[-10, 10]] * 3)

    # Khá»Ÿi táº¡o mÃ´ hÃ¬nh GA
    model = ga(function=complex_function, 
               dimension=3, 
               variable_type='real', 
               variable_boundaries=varbound)

    # Cháº¡y thuáº­t toÃ¡n
    print("Báº¯t Ä‘áº§u cháº¡y Thuáº­t toÃ¡n Di truyá»n...")
    model.run()
    
    print("ÄÃ£ tÃ¬m tháº¥y giáº£i phÃ¡p tá»‘i Æ°u:")
    print(model.best_variable)
    print(f"GiÃ¡ trá»‹ tá»‘i Æ°u (nhá» nháº¥t) tÃ¬m Ä‘Æ°á»£c: {model.best_function}")

---

### **âœï¸ BÃ i thá»±c hÃ nh:**

BÃ i thá»±c hÃ nh nÃ y mang tÃ­nh tÆ° duy, khÃ´ng cáº§n code.

1.  **PhÃ¢n tÃ­ch TÃ¬nh huá»‘ng:**
    * Báº¡n Ä‘ang cá»‘ gáº¯ng tÃ¬m ra **kiáº¿n trÃºc tá»‘t nháº¥t** cho má»™t máº¡ng nÆ¡-ron. "Kiáº¿n trÃºc" á»Ÿ Ä‘Ã¢y bao gá»“m cÃ¡c lá»±a chá»n rá»i ráº¡c nhÆ°: "dÃ¹ng bao nhiÃªu táº§ng?", "má»—i táº§ng bao nhiÃªu nÆ¡-ron?", "dÃ¹ng hÃ m kÃ­ch hoáº¡t nÃ o ('relu' hay 'tanh')?".
    * Táº¡i sao **Gradient Descent** **khÃ´ng thá»ƒ** Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ giáº£i quyáº¿t trá»±c tiáº¿p bÃ i toÃ¡n tá»‘i Æ°u hÃ³a nÃ y?
    * Táº¡i sao **Thuáº­t toÃ¡n Di truyá»n (GA)** láº¡i lÃ  má»™t lá»±a chá»n phÃ¹ há»£p? (Gá»£i Ã½: "Gen" cá»§a má»™t "cÃ¡ thá»ƒ" trong bÃ i toÃ¡n nÃ y sáº½ lÃ  gÃ¬?)