# Giai Ä‘oáº¡n 4: Nháº­p mÃ´n Há»c MÃ¡y vÃ  cÃ¡c NguyÃªn lÃ½ Cá»‘t lÃµi
## BÃ i 4.5: Huáº¥n luyá»‡n & ÄÃ¡nh giÃ¡ MÃ´ hÃ¬nh PhÃ¢n loáº¡i

### **ğŸ¯ Má»¥c tiÃªu bÃ i há»c:**
1.  Hiá»ƒu quy trÃ¬nh huáº¥n luyá»‡n vÃ  dá»± Ä‘oÃ¡n cÆ¡ báº£n (`.fit()`, `.predict()`).
2.  Náº¯m vá»¯ng **Ma tráº­n nháº§m láº«n (Confusion Matrix)**, ná»n táº£ng cá»§a má»i chá»‰ sá»‘ Ä‘Ã¡nh giÃ¡.
3.  PhÃ¢n tÃ­ch sÃ¢u vá» sá»± Ä‘Ã¡nh Ä‘á»•i giá»¯a **Precision** vÃ  **Recall**.
4.  Biáº¿t cÃ¡ch sá»­ dá»¥ng cÃ¡c chá»‰ sá»‘ tá»•ng há»£p nhÆ° **F1-Score** vÃ  **AUC**.

---

### **Bá»‘i cáº£nh & Táº§m quan trá»ng**

Sau khi Ä‘Ã£ chuáº©n bá»‹ dá»¯ liá»‡u má»™t cÃ¡ch cáº©n tháº­n, Ä‘Ã¢y lÃ  "khoáº£nh kháº¯c cá»§a sá»± tháº­t". ChÃºng ta sáº½ Ä‘Æ°a dá»¯ liá»‡u Ä‘Ã³ cho mÃ´ hÃ¬nh Ä‘á»ƒ nÃ³ há»c. NhÆ°ng viá»‡c há»c xong khÃ´ng cÃ³ Ã½ nghÄ©a náº¿u chÃºng ta khÃ´ng biáº¿t cÃ¡ch Ä‘Ã¡nh giÃ¡.

Má»™t nhÃ  khoa há»c dá»¯ liá»‡u khÃ´ng thá»ƒ chá»‰ nÃ³i "mÃ´ hÃ¬nh cá»§a tÃ´i cháº¡y tá»‘t". Há» pháº£i chá»©ng minh Ä‘iá»u Ä‘Ã³ báº±ng nhá»¯ng con sá»‘ cá»¥ thá»ƒ. BÃ i há»c nÃ y sáº½ cung cáº¥p cho báº¡n bá»™ cÃ´ng cá»¥ Ä‘á»ƒ "Ä‘á»‹nh lÆ°á»£ng" hiá»‡u nÄƒng cá»§a má»™t mÃ´ hÃ¬nh phÃ¢n loáº¡i, giÃºp báº¡n so sÃ¡nh cÃ¡c thuáº­t toÃ¡n khÃ¡c nhau vÃ  chá»n ra cÃ¡i tá»‘t nháº¥t.

---

### **LÃ½ thuyáº¿t Cá»‘t lÃµi & Triá»ƒn khai**

#### **1. Quy trÃ¬nh `fit` vÃ  `predict`**

* **`.fit(X_train, y_train)`:** ÄÃ¢y lÃ  quÃ¡ trÃ¬nh **huáº¥n luyá»‡n**. ChÃºng ta Ä‘Æ°a cho mÃ´ hÃ¬nh cáº£ "Ä‘á» bÃ i" (`X_train`) vÃ  "Ä‘Ã¡p Ã¡n" (`y_train`). MÃ´ hÃ¬nh sáº½ cá»‘ gáº¯ng tÃ¬m ra quy luáº­t ná»™i táº¡i Ä‘á»ƒ Ã¡nh xáº¡ tá»« `X` sang `y`. Vá» máº·t ká»¹ thuáº­t, Ä‘Ã¢y lÃ  lÃºc thuáº­t toÃ¡n tá»‘i Æ°u hÃ³a (nhÆ° Gradient Descent) hoáº¡t Ä‘á»™ng Ä‘á»ƒ tÃ¬m ra cÃ¡c tham sá»‘ tá»‘t nháº¥t.
* **`.predict(X_test)`:** ÄÃ¢y lÃ  quÃ¡ trÃ¬nh **dá»± Ä‘oÃ¡n**. ChÃºng ta chá»‰ Ä‘Æ°a cho mÃ´ hÃ¬nh "Ä‘á» bÃ i" má»›i (`X_test`) mÃ  nÃ³ chÆ°a tá»«ng tháº¥y, vÃ  yÃªu cáº§u nÃ³ Ä‘Æ°a ra "Ä‘Ã¡p Ã¡n" dá»± Ä‘oÃ¡n.


    # Code vÃ­ dá»¥ (sá»­ dá»¥ng dá»¯ liá»‡u Ä‘Ã£ xá»­ lÃ½ tá»« bÃ i trÆ°á»›c)
    from sklearn.linear_model import LogisticRegression

    # Giáº£ sá»­ X_train_processed vÃ  X_test_processed Ä‘Ã£ cÃ³
    # 1. Khá»Ÿi táº¡o mÃ´ hÃ¬nh
    model = LogisticRegression(random_state=42)

    # 2. Huáº¥n luyá»‡n mÃ´ hÃ¬nh
    model.fit(X_train_processed, y_train)

    # 3. ÄÆ°a ra dá»± Ä‘oÃ¡n trÃªn táº­p test
    y_pred = model.predict(X_test_processed)

#### **2. Ma tráº­n nháº§m láº«n (Confusion Matrix)**

ÄÃ¢y lÃ  cÃ¡ch tá»‘t nháº¥t Ä‘á»ƒ xem xÃ©t chi tiáº¿t káº¿t quáº£ dá»± Ä‘oÃ¡n. NÃ³ lÃ  má»™t báº£ng 2x2 so sÃ¡nh giá»¯a **GiÃ¡ trá»‹ Thá»±c táº¿** vÃ  **GiÃ¡ trá»‹ Dá»± Ä‘oÃ¡n**.



* **True Positive (TP):** Thá»±c táº¿ lÃ  1, dá»± Ä‘oÃ¡n lÃ  1 (Dá»± Ä‘oÃ¡n Ä‘Ãºng ngÆ°á»i sá»‘ng sÃ³t).
* **True Negative (TN):** Thá»±c táº¿ lÃ  0, dá»± Ä‘oÃ¡n lÃ  0 (Dá»± Ä‘oÃ¡n Ä‘Ãºng ngÆ°á»i tá»­ vong).
* **False Positive (FP) - Lá»—i Loáº¡i I:** Thá»±c táº¿ lÃ  0, dá»± Ä‘oÃ¡n lÃ  1 (Dá»± Ä‘oÃ¡n nháº§m ngÆ°á»i tá»­ vong thÃ nh sá»‘ng sÃ³t).
* **False Negative (FN) - Lá»—i Loáº¡i II:** Thá»±c táº¿ lÃ  1, dá»± Ä‘oÃ¡n lÃ  0 (Dá»± Ä‘oÃ¡n nháº§m ngÆ°á»i sá»‘ng sÃ³t thÃ nh tá»­ vong).


    from sklearn.metrics import confusion_matrix, ConfusionMatrixDisplay

    cm = confusion_matrix(y_test, y_pred)
    disp = ConfusionMatrixDisplay(confusion_matrix=cm)
    disp.plot()
    plt.title("Ma tráº­n Nháº§m láº«n")
    plt.show()

---

### **PhÃ¢n tÃ­ch ChuyÃªn sÃ¢u: CÃ¡c Chá»‰ sá»‘ ÄÃ¡nh giÃ¡**

Tá»« 4 giÃ¡ trá»‹ trong Ma tráº­n nháº§m láº«n, chÃºng ta cÃ³ thá»ƒ tÃ­nh ra cÃ¡c chá»‰ sá»‘ quan trá»ng.

#### **1. Accuracy (Äá»™ chÃ­nh xÃ¡c)**
* **CÃ´ng thá»©c:** `(TP + TN) / (Táº¥t cáº£)`
* **Ã nghÄ©a:** Tá»· lá»‡ pháº§n trÄƒm sá»‘ Ä‘iá»ƒm Ä‘Æ°á»£c dá»± Ä‘oÃ¡n Ä‘Ãºng trÃªn tá»•ng sá»‘ Ä‘iá»ƒm.
* **Cáº¡m báº«y:** Ráº¥t dá»… gÃ¢y hiá»ƒu láº§m khi dá»¯ liá»‡u bá»‹ **máº¥t cÃ¢n báº±ng**. VÃ­ dá»¥, náº¿u 95% email lÃ  khÃ´ng spam, má»™t mÃ´ hÃ¬nh ngu ngá»‘c chá»‰ cáº§n dá»± Ä‘oÃ¡n "khÃ´ng spam" cho má»i email lÃ  Ä‘Ã£ Ä‘áº¡t Accuracy 95%, nhÆ°ng nÃ³ hoÃ n toÃ n vÃ´ dá»¥ng.

#### **2. Precision (Äá»™ chuáº©n)**
* **CÃ´ng thá»©c:** `TP / (TP + FP)`
* **Ã nghÄ©a:** Trong sá»‘ táº¥t cáº£ cÃ¡c láº§n mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n lÃ  "Positve" (vÃ­ dá»¥: Sá»‘ng sÃ³t), cÃ³ bao nhiÃªu láº§n lÃ  Ä‘Ãºng?
* **Khi nÃ o quan trá»ng?** Khi báº¡n muá»‘n **trÃ¡nh sai láº§m False Positive**.
    * *VÃ­ dá»¥:* Lá»c email spam. Má»™t False Positive (email quan trá»ng bá»‹ cho vÃ o hÃ²m spam) lÃ  ráº¥t tá»‡. ChÃºng ta cáº§n Precision cao.

#### **3. Recall (Äá»™ bao phá»§ / Äá»™ nháº¡y)**
* **CÃ´ng thá»©c:** `TP / (TP + FN)`
* **Ã nghÄ©a:** Trong sá»‘ táº¥t cáº£ cÃ¡c trÆ°á»ng há»£p thá»±c sá»± lÃ  "Positive" trong thá»±c táº¿, mÃ´ hÃ¬nh tÃ¬m ra Ä‘Æ°á»£c bao nhiÃªu pháº§n trÄƒm?
* **Khi nÃ o quan trá»ng?** Khi báº¡n muá»‘n **trÃ¡nh sai láº§m False Negative**.
    * *VÃ­ dá»¥:* Cháº©n Ä‘oÃ¡n bá»‡nh ung thÆ°. Má»™t False Negative (bá» sÃ³t bá»‡nh nhÃ¢n) lÃ  má»™t tháº£m há»a. ChÃºng ta cáº§n Recall cao.

#### **4. F1-Score**
* **CÃ´ng thá»©c:** `2 * (Precision * Recall) / (Precision + Recall)`
* **Ã nghÄ©a:** LÃ  trung bÃ¬nh Ä‘iá»u hÃ²a cá»§a Precision vÃ  Recall. NÃ³ lÃ  má»™t chá»‰ sá»‘ duy nháº¥t Ä‘á»ƒ Ä‘o lÆ°á»ng hiá»‡u nÄƒng khi báº¡n cáº§n cÃ¢n báº±ng giá»¯a cáº£ hai.


    # Láº¥y bÃ¡o cÃ¡o chi tiáº¿t
    from sklearn.metrics import classification_report
    print(classification_report(y_test, y_pred))

---

### **âœï¸ BÃ i thá»±c hÃ nh:**

1.  **PhÃ¢n tÃ­ch sá»± ÄÃ¡nh Ä‘á»•i:**
    * **TÃ¬nh huá»‘ng A:** Báº¡n Ä‘ang xÃ¢y dá»±ng má»™t mÃ´ hÃ¬nh AI Ä‘á»ƒ duyá»‡t cÃ¡c video trÃªn má»™t ná»n táº£ng cho tráº» em vÃ  tá»± Ä‘á»™ng gá»¡ xuá»‘ng cÃ¡c video cÃ³ ná»™i dung khÃ´ng phÃ¹ há»£p. Trong trÆ°á»ng há»£p nÃ y, giá»¯a **Precision** vÃ  **Recall**, báº¡n sáº½ Æ°u tiÃªn chá»‰ sá»‘ nÃ o hÆ¡n? HÃ£y giáº£i thÃ­ch táº¡i sao. (Gá»£i Ã½: "Positive" á»Ÿ Ä‘Ã¢y lÃ  "video khÃ´ng phÃ¹ há»£p". HÃ£y nghÄ© xem False Positive vÃ  False Negative cÃ³ nghÄ©a lÃ  gÃ¬ trong tÃ¬nh huá»‘ng nÃ y).
2.  **Huáº¥n luyá»‡n vÃ  ÄÃ¡nh giÃ¡ má»™t mÃ´ hÃ¬nh khÃ¡c:**
    * Import `RandomForestClassifier` tá»« `sklearn.ensemble`.
    * Huáº¥n luyá»‡n má»™t mÃ´ hÃ¬nh Random Forest trÃªn cÃ¹ng bá»™ dá»¯ liá»‡u `X_train_processed` vÃ  `y_train`.
    * ÄÆ°a ra dá»± Ä‘oÃ¡n trÃªn `X_test_processed`.
    * In ra `classification_report` vÃ  `confusion_matrix` cho mÃ´ hÃ¬nh Random Forest. So sÃ¡nh káº¿t quáº£ cá»§a nÃ³ (Ä‘áº·c biá»‡t lÃ  F1-score) vá»›i mÃ´ hÃ¬nh `LogisticRegression` Ä‘Ã£ lÃ m trong bÃ i. Báº¡n tháº¥y mÃ´ hÃ¬nh nÃ o hoáº¡t Ä‘á»™ng tá»‘t hÆ¡n?