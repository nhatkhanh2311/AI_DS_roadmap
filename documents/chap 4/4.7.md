# Giai đoạn 4: Nhập môn Học Máy và các Nguyên lý Cốt lõi
## Bài 4.7: Vấn đề Cốt lõi: Overfitting, Underfitting & Sự đánh đổi

### **🎯 Mục tiêu bài học:**
1.  Hiểu và nhận diện được hai vấn đề phổ biến nhất: **Overfitting** và **Underfitting**.
2.  Nắm vững khái niệm lý thuyết nền tảng: **Sự đánh đổi Giữa Độ chệch và Phương sai (Bias-Variance Tradeoff)**.
3.  Làm quen với **Regularization** như một phương pháp chính để chống lại Overfitting.

---

### **Bối cảnh & Tầm quan trọng**

Sau khi huấn luyện và đánh giá mô hình, bạn có thể thấy kết quả không như ý. Nguyên nhân thường rơi vào một trong hai thái cực: mô hình của bạn hoặc là quá "ngây thơ" không học được gì, hoặc là quá "máy móc" đến mức học thuộc lòng cả những chi tiết nhiễu.

Việc chẩn đoán đúng "căn bệnh" (Underfitting hay Overfitting) sẽ quyết định bạn nên dùng "phương thuốc" nào: làm cho mô hình phức tạp hơn hay đơn giản đi, thêm dữ liệu hay giảm bớt đặc trưng.

---

### **Lý thuyết Cốt lõi**

#### **1. Underfitting (Học chưa tới)**
* **Triệu chứng:** Mô hình hoạt động tệ trên **cả** tập huấn luyện (train set) và tập kiểm tra (test set).
* **Nguyên nhân:** Mô hình quá đơn giản, không đủ năng lực để nắm bắt quy luật phức tạp của dữ liệu.
* **Analogy:** Giống như một học sinh chỉ học sơ sơ, nên khi làm bài tập (train set) hay đi thi (test set) đều bị điểm kém.
* **Về mặt lý thuyết:** Mô hình có **Độ chệch cao (High Bias)**. "Bias" là sai số đến từ những giả định sai lầm của mô hình. Một mô hình đơn giản (ví dụ: mô hình tuyến tính) giả định rằng dữ liệu có mối quan hệ tuyến tính, nếu thực tế không phải vậy, nó sẽ luôn dự đoán sai.

#### **2. Overfitting (Học vẹt)**
* **Triệu chứng:** Mô hình hoạt động **cực kỳ tốt** trên tập huấn luyện, nhưng lại **rất tệ** trên tập kiểm tra.
* **Nguyên nhân:** Mô hình quá phức tạp, nó không chỉ học "tín hiệu" (signal) mà còn học thuộc lòng cả "nhiễu" (noise) trong dữ liệu huấn luyện. Vì nhiễu không xuất hiện lại trong dữ liệu mới, mô hình sẽ dự đoán sai.
* **Analogy:** Giống như một học sinh học thuộc lòng từng chữ trong sách bài tập. Khi làm lại bài tập đó (train set) thì đạt điểm tuyệt đối, nhưng khi đi thi (test set) gặp một câu hỏi hơi khác một chút là không làm được.
* **Về mặt lý thuyết:** Mô hình có **Phương sai cao (High Variance)**. "Variance" là sai số đến từ sự nhạy cảm quá mức của mô hình với những thay đổi nhỏ trong dữ liệu huấn luyện. Một mô hình phức tạp sẽ cố gắng "uốn mình" theo mọi điểm dữ liệu, kể cả các điểm nhiễu.

#### **3. Sự đánh đổi Giữa Độ chệch và Phương sai (Bias-Variance Tradeoff)**

Đây là một quy luật nền tảng trong Machine Learning:
* Khi bạn tăng độ phức tạp của mô hình, **Bias sẽ giảm** (mô hình học được quy luật phức tạp hơn) nhưng **Variance sẽ tăng** (mô hình dễ học vẹt hơn).
* Ngược lại, khi bạn giảm độ phức tạp, **Variance sẽ giảm** nhưng **Bias sẽ tăng**.

**Mục tiêu của chúng ta:** Tìm một điểm cân bằng, một mô hình đủ phức tạp để nắm bắt quy luật (Low Bias) nhưng không quá phức tạp để học vẹt (Low Variance). 

---

### **Giải pháp: Regularization (Chính quy hóa)**

**Regularization** là một tập hợp các kỹ thuật được thêm vào quá trình huấn luyện để **ngăn chặn Overfitting** bằng cách "trừng phạt" các mô hình quá phức tạp.

* **Ý tưởng:** Chúng ta sẽ sửa đổi Hàm mất mát (Loss Function) một chút.
    * $J_{\text{mới}}(\theta) = J_{\text{cũ}}(\theta) + \text{Thành phần phạt}$
* **Thành phần phạt:** Sẽ có giá trị lớn khi các tham số (trọng số) của mô hình có giá trị lớn. Một mô hình phức tạp thường có các trọng số lớn. Bằng cách bắt mô hình phải tối thiểu hóa cả sai số dự đoán VÀ độ lớn của các trọng số, chúng ta đang khuyến khích nó tìm ra một lời giải **đơn giản hơn**.

Hai loại Regularization phổ biến nhất là **L1 (Lasso)** và **L2 (Ridge)**, chúng ta sẽ đi sâu vào chúng khi học về các mô hình cụ thể ở Giai đoạn 5.

---

### **✍️ Bài thực hành (Tư duy & Chẩn đoán):**

Với mỗi tình huống dưới đây, hãy chẩn đoán xem mô hình đang gặp vấn đề gì (**Underfitting**, **Overfitting**, hay **Good Fit**) và đề xuất một giải pháp khả thi.

1.  **Tình huống 1:**
    * Độ chính xác trên tập Train: **99.8%**
    * Độ chính xác trên tập Test: **85.0%**
    * **Chẩn đoán & Giải pháp:** ?

2.  **Tình huống 2:**
    * Độ chính xác trên tập Train: **65.0%**
    * Độ chính xác trên tập Test: **64.5%**
    * **Chẩn đoán & Giải pháp:** ?

3.  **Tình huống 3:**
    * Bạn đang dùng một mô hình Hồi quy Tuyến tính đơn giản để dự đoán giá nhà. Sai số trên cả tập train và test đều rất cao. Bạn vẽ đồ thị và thấy mối quan hệ giữa diện tích và giá nhà rõ ràng là một đường cong chứ không phải đường thẳng.
    * **Chẩn đoán & Giải pháp:** ?

4.  **Tình huống 4:**
    * Mô hình Cây Quyết định của bạn cho kết quả hoàn hảo trên tập train, nhưng rất tệ trên tập test. Bạn kiểm tra và thấy cây có độ sâu tối đa là 25, với nhiều nhánh chỉ dùng để phân loại đúng 1-2 điểm dữ liệu.
    * **Chẩn đoán & Giải pháp:** ?