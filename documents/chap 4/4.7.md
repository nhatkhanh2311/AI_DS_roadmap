# Giai Ä‘oáº¡n 4: Nháº­p mÃ´n Há»c MÃ¡y vÃ  cÃ¡c NguyÃªn lÃ½ Cá»‘t lÃµi
## BÃ i 4.7: Váº¥n Ä‘á» Cá»‘t lÃµi: Overfitting, Underfitting & Sá»± Ä‘Ã¡nh Ä‘á»•i

### **ğŸ¯ Má»¥c tiÃªu bÃ i há»c:**
1.  Hiá»ƒu vÃ  nháº­n diá»‡n Ä‘Æ°á»£c hai váº¥n Ä‘á» phá»• biáº¿n nháº¥t: **Overfitting** vÃ  **Underfitting**.
2.  Náº¯m vá»¯ng khÃ¡i niá»‡m lÃ½ thuyáº¿t ná»n táº£ng: **Sá»± Ä‘Ã¡nh Ä‘á»•i Giá»¯a Äá»™ chá»‡ch vÃ  PhÆ°Æ¡ng sai (Bias-Variance Tradeoff)**.
3.  LÃ m quen vá»›i **Regularization** nhÆ° má»™t phÆ°Æ¡ng phÃ¡p chÃ­nh Ä‘á»ƒ chá»‘ng láº¡i Overfitting.

---

### **Bá»‘i cáº£nh & Táº§m quan trá»ng**

Sau khi huáº¥n luyá»‡n vÃ  Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh, báº¡n cÃ³ thá»ƒ tháº¥y káº¿t quáº£ khÃ´ng nhÆ° Ã½. NguyÃªn nhÃ¢n thÆ°á»ng rÆ¡i vÃ o má»™t trong hai thÃ¡i cá»±c: mÃ´ hÃ¬nh cá»§a báº¡n hoáº·c lÃ  quÃ¡ "ngÃ¢y thÆ¡" khÃ´ng há»c Ä‘Æ°á»£c gÃ¬, hoáº·c lÃ  quÃ¡ "mÃ¡y mÃ³c" Ä‘áº¿n má»©c há»c thuá»™c lÃ²ng cáº£ nhá»¯ng chi tiáº¿t nhiá»…u.

Viá»‡c cháº©n Ä‘oÃ¡n Ä‘Ãºng "cÄƒn bá»‡nh" (Underfitting hay Overfitting) sáº½ quyáº¿t Ä‘á»‹nh báº¡n nÃªn dÃ¹ng "phÆ°Æ¡ng thuá»‘c" nÃ o: lÃ m cho mÃ´ hÃ¬nh phá»©c táº¡p hÆ¡n hay Ä‘Æ¡n giáº£n Ä‘i, thÃªm dá»¯ liá»‡u hay giáº£m bá»›t Ä‘áº·c trÆ°ng.

---

### **LÃ½ thuyáº¿t Cá»‘t lÃµi**

#### **1. Underfitting (Há»c chÆ°a tá»›i)**
* **Triá»‡u chá»©ng:** MÃ´ hÃ¬nh hoáº¡t Ä‘á»™ng tá»‡ trÃªn **cáº£** táº­p huáº¥n luyá»‡n (train set) vÃ  táº­p kiá»ƒm tra (test set).
* **NguyÃªn nhÃ¢n:** MÃ´ hÃ¬nh quÃ¡ Ä‘Æ¡n giáº£n, khÃ´ng Ä‘á»§ nÄƒng lá»±c Ä‘á»ƒ náº¯m báº¯t quy luáº­t phá»©c táº¡p cá»§a dá»¯ liá»‡u.
* **Analogy:** Giá»‘ng nhÆ° má»™t há»c sinh chá»‰ há»c sÆ¡ sÆ¡, nÃªn khi lÃ m bÃ i táº­p (train set) hay Ä‘i thi (test set) Ä‘á»u bá»‹ Ä‘iá»ƒm kÃ©m.
* **Vá» máº·t lÃ½ thuyáº¿t:** MÃ´ hÃ¬nh cÃ³ **Äá»™ chá»‡ch cao (High Bias)**. "Bias" lÃ  sai sá»‘ Ä‘áº¿n tá»« nhá»¯ng giáº£ Ä‘á»‹nh sai láº§m cá»§a mÃ´ hÃ¬nh. Má»™t mÃ´ hÃ¬nh Ä‘Æ¡n giáº£n (vÃ­ dá»¥: mÃ´ hÃ¬nh tuyáº¿n tÃ­nh) giáº£ Ä‘á»‹nh ráº±ng dá»¯ liá»‡u cÃ³ má»‘i quan há»‡ tuyáº¿n tÃ­nh, náº¿u thá»±c táº¿ khÃ´ng pháº£i váº­y, nÃ³ sáº½ luÃ´n dá»± Ä‘oÃ¡n sai.

#### **2. Overfitting (Há»c váº¹t)**
* **Triá»‡u chá»©ng:** MÃ´ hÃ¬nh hoáº¡t Ä‘á»™ng **cá»±c ká»³ tá»‘t** trÃªn táº­p huáº¥n luyá»‡n, nhÆ°ng láº¡i **ráº¥t tá»‡** trÃªn táº­p kiá»ƒm tra.
* **NguyÃªn nhÃ¢n:** MÃ´ hÃ¬nh quÃ¡ phá»©c táº¡p, nÃ³ khÃ´ng chá»‰ há»c "tÃ­n hiá»‡u" (signal) mÃ  cÃ²n há»c thuá»™c lÃ²ng cáº£ "nhiá»…u" (noise) trong dá»¯ liá»‡u huáº¥n luyá»‡n. VÃ¬ nhiá»…u khÃ´ng xuáº¥t hiá»‡n láº¡i trong dá»¯ liá»‡u má»›i, mÃ´ hÃ¬nh sáº½ dá»± Ä‘oÃ¡n sai.
* **Analogy:** Giá»‘ng nhÆ° má»™t há»c sinh há»c thuá»™c lÃ²ng tá»«ng chá»¯ trong sÃ¡ch bÃ i táº­p. Khi lÃ m láº¡i bÃ i táº­p Ä‘Ã³ (train set) thÃ¬ Ä‘áº¡t Ä‘iá»ƒm tuyá»‡t Ä‘á»‘i, nhÆ°ng khi Ä‘i thi (test set) gáº·p má»™t cÃ¢u há»i hÆ¡i khÃ¡c má»™t chÃºt lÃ  khÃ´ng lÃ m Ä‘Æ°á»£c.
* **Vá» máº·t lÃ½ thuyáº¿t:** MÃ´ hÃ¬nh cÃ³ **PhÆ°Æ¡ng sai cao (High Variance)**. "Variance" lÃ  sai sá»‘ Ä‘áº¿n tá»« sá»± nháº¡y cáº£m quÃ¡ má»©c cá»§a mÃ´ hÃ¬nh vá»›i nhá»¯ng thay Ä‘á»•i nhá» trong dá»¯ liá»‡u huáº¥n luyá»‡n. Má»™t mÃ´ hÃ¬nh phá»©c táº¡p sáº½ cá»‘ gáº¯ng "uá»‘n mÃ¬nh" theo má»i Ä‘iá»ƒm dá»¯ liá»‡u, ká»ƒ cáº£ cÃ¡c Ä‘iá»ƒm nhiá»…u.

#### **3. Sá»± Ä‘Ã¡nh Ä‘á»•i Giá»¯a Äá»™ chá»‡ch vÃ  PhÆ°Æ¡ng sai (Bias-Variance Tradeoff)**

ÄÃ¢y lÃ  má»™t quy luáº­t ná»n táº£ng trong Machine Learning:
* Khi báº¡n tÄƒng Ä‘á»™ phá»©c táº¡p cá»§a mÃ´ hÃ¬nh, **Bias sáº½ giáº£m** (mÃ´ hÃ¬nh há»c Ä‘Æ°á»£c quy luáº­t phá»©c táº¡p hÆ¡n) nhÆ°ng **Variance sáº½ tÄƒng** (mÃ´ hÃ¬nh dá»… há»c váº¹t hÆ¡n).
* NgÆ°á»£c láº¡i, khi báº¡n giáº£m Ä‘á»™ phá»©c táº¡p, **Variance sáº½ giáº£m** nhÆ°ng **Bias sáº½ tÄƒng**.

**Má»¥c tiÃªu cá»§a chÃºng ta:** TÃ¬m má»™t Ä‘iá»ƒm cÃ¢n báº±ng, má»™t mÃ´ hÃ¬nh Ä‘á»§ phá»©c táº¡p Ä‘á»ƒ náº¯m báº¯t quy luáº­t (Low Bias) nhÆ°ng khÃ´ng quÃ¡ phá»©c táº¡p Ä‘á»ƒ há»c váº¹t (Low Variance). 

---

### **Giáº£i phÃ¡p: Regularization (ChÃ­nh quy hÃ³a)**

**Regularization** lÃ  má»™t táº­p há»£p cÃ¡c ká»¹ thuáº­t Ä‘Æ°á»£c thÃªm vÃ o quÃ¡ trÃ¬nh huáº¥n luyá»‡n Ä‘á»ƒ **ngÄƒn cháº·n Overfitting** báº±ng cÃ¡ch "trá»«ng pháº¡t" cÃ¡c mÃ´ hÃ¬nh quÃ¡ phá»©c táº¡p.

* **Ã tÆ°á»Ÿng:** ChÃºng ta sáº½ sá»­a Ä‘á»•i HÃ m máº¥t mÃ¡t (Loss Function) má»™t chÃºt.
    * $J_{\text{má»›i}}(\theta) = J_{\text{cÅ©}}(\theta) + \text{ThÃ nh pháº§n pháº¡t}$
* **ThÃ nh pháº§n pháº¡t:** Sáº½ cÃ³ giÃ¡ trá»‹ lá»›n khi cÃ¡c tham sá»‘ (trá»ng sá»‘) cá»§a mÃ´ hÃ¬nh cÃ³ giÃ¡ trá»‹ lá»›n. Má»™t mÃ´ hÃ¬nh phá»©c táº¡p thÆ°á»ng cÃ³ cÃ¡c trá»ng sá»‘ lá»›n. Báº±ng cÃ¡ch báº¯t mÃ´ hÃ¬nh pháº£i tá»‘i thiá»ƒu hÃ³a cáº£ sai sá»‘ dá»± Ä‘oÃ¡n VÃ€ Ä‘á»™ lá»›n cá»§a cÃ¡c trá»ng sá»‘, chÃºng ta Ä‘ang khuyáº¿n khÃ­ch nÃ³ tÃ¬m ra má»™t lá»i giáº£i **Ä‘Æ¡n giáº£n hÆ¡n**.

Hai loáº¡i Regularization phá»• biáº¿n nháº¥t lÃ  **L1 (Lasso)** vÃ  **L2 (Ridge)**, chÃºng ta sáº½ Ä‘i sÃ¢u vÃ o chÃºng khi há»c vá» cÃ¡c mÃ´ hÃ¬nh cá»¥ thá»ƒ á»Ÿ Giai Ä‘oáº¡n 5.

---

### **âœï¸ BÃ i thá»±c hÃ nh (TÆ° duy & Cháº©n Ä‘oÃ¡n):**

Vá»›i má»—i tÃ¬nh huá»‘ng dÆ°á»›i Ä‘Ã¢y, hÃ£y cháº©n Ä‘oÃ¡n xem mÃ´ hÃ¬nh Ä‘ang gáº·p váº¥n Ä‘á» gÃ¬ (**Underfitting**, **Overfitting**, hay **Good Fit**) vÃ  Ä‘á» xuáº¥t má»™t giáº£i phÃ¡p kháº£ thi.

1.  **TÃ¬nh huá»‘ng 1:**
    * Äá»™ chÃ­nh xÃ¡c trÃªn táº­p Train: **99.8%**
    * Äá»™ chÃ­nh xÃ¡c trÃªn táº­p Test: **85.0%**
    * **Cháº©n Ä‘oÃ¡n & Giáº£i phÃ¡p:** ?

2.  **TÃ¬nh huá»‘ng 2:**
    * Äá»™ chÃ­nh xÃ¡c trÃªn táº­p Train: **65.0%**
    * Äá»™ chÃ­nh xÃ¡c trÃªn táº­p Test: **64.5%**
    * **Cháº©n Ä‘oÃ¡n & Giáº£i phÃ¡p:** ?

3.  **TÃ¬nh huá»‘ng 3:**
    * Báº¡n Ä‘ang dÃ¹ng má»™t mÃ´ hÃ¬nh Há»“i quy Tuyáº¿n tÃ­nh Ä‘Æ¡n giáº£n Ä‘á»ƒ dá»± Ä‘oÃ¡n giÃ¡ nhÃ . Sai sá»‘ trÃªn cáº£ táº­p train vÃ  test Ä‘á»u ráº¥t cao. Báº¡n váº½ Ä‘á»“ thá»‹ vÃ  tháº¥y má»‘i quan há»‡ giá»¯a diá»‡n tÃ­ch vÃ  giÃ¡ nhÃ  rÃµ rÃ ng lÃ  má»™t Ä‘Æ°á»ng cong chá»© khÃ´ng pháº£i Ä‘Æ°á»ng tháº³ng.
    * **Cháº©n Ä‘oÃ¡n & Giáº£i phÃ¡p:** ?

4.  **TÃ¬nh huá»‘ng 4:**
    * MÃ´ hÃ¬nh CÃ¢y Quyáº¿t Ä‘á»‹nh cá»§a báº¡n cho káº¿t quáº£ hoÃ n háº£o trÃªn táº­p train, nhÆ°ng ráº¥t tá»‡ trÃªn táº­p test. Báº¡n kiá»ƒm tra vÃ  tháº¥y cÃ¢y cÃ³ Ä‘á»™ sÃ¢u tá»‘i Ä‘a lÃ  25, vá»›i nhiá»u nhÃ¡nh chá»‰ dÃ¹ng Ä‘á»ƒ phÃ¢n loáº¡i Ä‘Ãºng 1-2 Ä‘iá»ƒm dá»¯ liá»‡u.
    * **Cháº©n Ä‘oÃ¡n & Giáº£i phÃ¡p:** ?