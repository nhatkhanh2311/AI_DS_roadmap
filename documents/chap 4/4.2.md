# Giai Ä‘oáº¡n 4: Nháº­p mÃ´n Há»c MÃ¡y vÃ  cÃ¡c NguyÃªn lÃ½ Cá»‘t lÃµi
## BÃ i 4.2: Tiá»n xá»­ lÃ½ Dá»¯ liá»‡u CÆ¡ báº£n (Train-Test Split, Xá»­ lÃ½ GiÃ¡ trá»‹ thiáº¿u)

### **ğŸ¯ Má»¥c tiÃªu bÃ i há»c:**
1.  Hiá»ƒu táº¡i sao viá»‡c **chia dá»¯ liá»‡u (Train-Test Split)** lÃ  bÆ°á»›c báº¯t buá»™c Ä‘á»ƒ Ä‘Ã¡nh giÃ¡ mÃ´ hÃ¬nh má»™t cÃ¡ch khÃ¡ch quan.
2.  Náº¯m vá»¯ng cÃ¡c chiáº¿n lÆ°á»£c xá»­ lÃ½ **giÃ¡ trá»‹ thiáº¿u (missing values)** vÃ  phÃ¢n tÃ­ch Æ°u/nhÆ°á»£c Ä‘iá»ƒm cá»§a chÃºng.
3.  Thá»±c hÃ nh cÃ¡c ká»¹ thuáº­t nÃ y báº±ng thÆ° viá»‡n Scikit-learn vÃ  Pandas.

---

### **Bá»‘i cáº£nh & Táº§m quan trá»ng**

Trong tháº¿ giá»›i thá»±c, dá»¯ liá»‡u khÃ´ng bao giá» hoÃ n háº£o. NÃ³ thÆ°á»ng bá»‹ thiáº¿u thÃ´ng tin, khÃ´ng nháº¥t quÃ¡n vÃ  lá»™n xá»™n. Viá»‡c Ä‘Æ°a dá»¯ liá»‡u thÃ´ trá»±c tiáº¿p vÃ o má»™t thuáº­t toÃ¡n há»c mÃ¡y cÅ©ng giá»‘ng nhÆ° Ä‘Æ°a bÃ¹n Ä‘áº¥t vÃ o má»™t Ä‘á»™ng cÆ¡ F1â€”nÃ³ sáº½ khÃ´ng hoáº¡t Ä‘á»™ng, tháº­m chÃ­ cÃ³ thá»ƒ gÃ¢y ra káº¿t quáº£ sai lá»‡ch nghiÃªm trá»ng.

BÃ i há»c nÃ y tuÃ¢n thá»§ nguyÃªn táº¯c vÃ ng: **"RÃ¡c Ä‘áº§u vÃ o, RÃ¡c Ä‘áº§u ra" (Garbage In, Garbage Out)**. Cháº¥t lÆ°á»£ng cá»§a mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n cá»§a báº¡n phá»¥ thuá»™c trá»±c tiáº¿p vÃ o cháº¥t lÆ°á»£ng cá»§a dá»¯ liá»‡u báº¡n dÃ¹ng Ä‘á»ƒ huáº¥n luyá»‡n nÃ³. Viá»‡c tiá»n xá»­ lÃ½ dá»¯ liá»‡u má»™t cÃ¡ch cáº©n tháº­n lÃ  má»™t trong nhá»¯ng cÃ´ng viá»‡c tá»‘n nhiá»u thá»i gian nháº¥t nhÆ°ng cÅ©ng mang láº¡i hiá»‡u quáº£ cao nháº¥t trong má»™t dá»± Ã¡n khoa há»c dá»¯ liá»‡u.

---

### **LÃ½ thuyáº¿t Cá»‘t lÃµi**

#### **1. PhÃ¢n chia Dá»¯ liá»‡u (Train-Test Split)**

**Váº¥n Ä‘á»:** LÃ m tháº¿ nÃ o Ä‘á»ƒ báº¡n biáº¿t mÃ´ hÃ¬nh cá»§a mÃ¬nh hoáº¡t Ä‘á»™ng tá»‘t? Náº¿u báº¡n huáº¥n luyá»‡n vÃ  kiá»ƒm tra mÃ´ hÃ¬nh trÃªn cÃ¹ng má»™t bá»™ dá»¯ liá»‡u, nÃ³ sáº½ giá»‘ng nhÆ° viá»‡c cho má»™t há»c sinh lÃ m bÃ i kiá»ƒm tra mÃ  Ä‘Ã£ biáº¿t trÆ°á»›c Ä‘á» vÃ  Ä‘Ã¡p Ã¡n. Há»c sinh Ä‘Ã³ cÃ³ thá»ƒ Ä‘áº¡t Ä‘iá»ƒm 100, nhÆ°ng Ä‘iá»u Ä‘Ã³ khÃ´ng cÃ³ nghÄ©a lÃ  há» thá»±c sá»± hiá»ƒu bÃ i. MÃ´ hÃ¬nh cÅ©ng váº­y, nÃ³ cÃ³ thá»ƒ "há»c váº¹t" (overfit) dá»¯ liá»‡u huáº¥n luyá»‡n vÃ  sáº½ hoáº¡t Ä‘á»™ng ráº¥t tá»‡ khi gáº·p dá»¯ liá»‡u má»›i trong thá»±c táº¿.

**Giáº£i phÃ¡p:** ChÃºng ta pháº£i mÃ´ phá»ng láº¡i tÃ¬nh huá»‘ng thá»±c táº¿ báº±ng cÃ¡ch chia dá»¯ liá»‡u cá»§a mÃ¬nh thÃ nh hai pháº§n:
* **Táº­p Huáº¥n luyá»‡n (Training Set):** (ThÆ°á»ng lÃ  70-80% dá»¯ liá»‡u) DÃ¹ng Ä‘á»ƒ "dáº¡y" cho mÃ´ hÃ¬nh. MÃ´ hÃ¬nh sáº½ xem cáº£ Ä‘áº·c trÆ°ng (X) vÃ  nhÃ£n (y) cá»§a táº­p nÃ y Ä‘á»ƒ há»c ra cÃ¡c quy luáº­t.
* **Táº­p Kiá»ƒm tra (Testing Set):** (ThÆ°á»ng lÃ  20-30% dá»¯ liá»‡u) DÃ¹ng Ä‘á»ƒ **Ä‘Ã¡nh giÃ¡** hiá»‡u nÄƒng cá»§a mÃ´ hÃ¬nh sau khi Ä‘Ã£ huáº¥n luyá»‡n xong. Táº­p nÃ y Ä‘Æ°á»£c coi nhÆ° "dá»¯ liá»‡u má»›i" mÃ  mÃ´ hÃ¬nh chÆ°a tá»«ng tháº¥y. ChÃºng ta sáº½ Ä‘Æ°a Ä‘áº·c trÆ°ng (X) cá»§a táº­p nÃ y cho mÃ´ hÃ¬nh dá»± Ä‘oÃ¡n vÃ  so sÃ¡nh káº¿t quáº£ vá»›i nhÃ£n (y) thá»±c táº¿.

**Quy táº¯c vÃ ng:** **Táº­p kiá»ƒm tra pháº£i Ä‘Æ°á»£c giá»¯ bÃ­ máº­t tuyá»‡t Ä‘á»‘i** cho Ä‘áº¿n bÆ°á»›c Ä‘Ã¡nh giÃ¡ cuá»‘i cÃ¹ng. Má»i quyáº¿t Ä‘á»‹nh vá» tiá»n xá»­ lÃ½ hay lá»±a chá»n mÃ´ hÃ¬nh Ä‘á»u pháº£i dá»±a trÃªn táº­p huáº¥n luyá»‡n.

#### **2. Xá»­ lÃ½ GiÃ¡ trá»‹ thiáº¿u (Missing Values)**

**Váº¥n Ä‘á»:** Háº§u háº¿t cÃ¡c thuáº­t toÃ¡n há»c mÃ¡y Ä‘á»u dá»±a trÃªn cÃ¡c phÃ©p toÃ¡n ma tráº­n vÃ  khÃ´ng thá»ƒ xá»­ lÃ½ cÃ¡c giÃ¡ trá»‹ bá»‹ thiáº¿u (thÆ°á»ng Ä‘Æ°á»£c biá»ƒu diá»…n lÃ  `NaN` - Not a Number).

**CÃ¡c chiáº¿n lÆ°á»£c xá»­ lÃ½:**

##### **a. XÃ³a bá» (Deletion)**
* **XÃ³a hÃ ng (Row Deletion):** XÃ³a toÃ n bá»™ hÃ ng cÃ³ chá»©a giÃ¡ trá»‹ thiáº¿u.
    * **Æ¯u Ä‘iá»ƒm:** ÄÆ¡n giáº£n.
    * **NhÆ°á»£c Ä‘iá»ƒm:** CÃ³ thá»ƒ lÃ m máº¥t ráº¥t nhiá»u dá»¯ liá»‡u quÃ½ giÃ¡ náº¿u cÃ³ nhiá»u hÃ ng bá»‹ thiáº¿u dÃ¹ chá»‰ má»™t cá»™t.
* **XÃ³a cá»™t (Column Deletion):** XÃ³a toÃ n bá»™ cá»™t náº¿u nÃ³ cÃ³ quÃ¡ nhiá»u giÃ¡ trá»‹ thiáº¿u.
    * **Æ¯u Ä‘iá»ƒm:** ÄÆ¡n giáº£n.
    * **NhÆ°á»£c Ä‘iá»ƒm:** CÃ³ thá»ƒ lÃ m máº¥t Ä‘i má»™t Ä‘áº·c trÆ°ng quan trá»ng.

##### **b. Äiá»n giÃ¡ trá»‹ (Imputation)**
ÄÃ¢y lÃ  phÆ°Æ¡ng phÃ¡p phá»• biáº¿n hÆ¡n: thay tháº¿ cÃ¡c giÃ¡ trá»‹ `NaN` báº±ng má»™t giÃ¡ trá»‹ Æ°á»›c tÃ­nh.
* **Äiá»n báº±ng Trung bÃ¬nh (Mean Imputation):** Thay tháº¿ báº±ng giÃ¡ trá»‹ trung bÃ¬nh cá»§a cá»™t.
    * **Æ¯u Ä‘iá»ƒm:** ÄÆ¡n giáº£n.
    * **NhÆ°á»£c Ä‘iá»ƒm:** Chá»‰ dÃ¹ng cho cá»™t sá»‘, ráº¥t nháº¡y cáº£m vá»›i giÃ¡ trá»‹ ngoáº¡i lai (outliers).
* **Äiá»n báº±ng Trung vá»‹ (Median Imputation):** Thay tháº¿ báº±ng giÃ¡ trá»‹ trung vá»‹ cá»§a cá»™t.
    * **Æ¯u Ä‘iá»ƒm:** ÄÆ¡n giáº£n, **khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng bá»Ÿi outliers**. Lá»±a chá»n tá»‘t hÆ¡n cho cÃ¡c cá»™t sá»‘ bá»‹ lá»‡ch.
* **Äiá»n báº±ng Yáº¿u vá»‹ (Mode Imputation):** Thay tháº¿ báº±ng giÃ¡ trá»‹ xuáº¥t hiá»‡n thÆ°á»ng xuyÃªn nháº¥t.
    * **Æ¯u Ä‘iá»ƒm:** CÃ³ thá»ƒ dÃ¹ng cho cáº£ cá»™t sá»‘ vÃ  **cá»™t háº¡ng má»¥c (categorical)**.

---

### **Triá»ƒn khai vá»›i Code**

    import pandas as pd
    from sklearn.model_selection import train_test_split

    df = pd.read_csv('titanic.csv')

    # --- 1. Train-Test Split ---
    # Äáº§u tiÃªn, tÃ¡ch Ä‘áº·c trÆ°ng (X) vÃ  nhÃ£n má»¥c tiÃªu (y)
    X = df.drop('Survived', axis=1) # Bá» cá»™t 'Survived' Ä‘á»ƒ cÃ³ X
    y = df['Survived']             # Láº¥y cá»™t 'Survived' lÃ m y

    # Thá»±c hiá»‡n chia dá»¯ liá»‡u
    # test_size=0.2: dÃ nh 20% cho táº­p test
    # random_state=42: Ä‘áº£m báº£o káº¿t quáº£ chia luÃ´n giá»‘ng nhau má»—i láº§n cháº¡y
    X_train, X_test, y_train, y_test = train_test_split(
        X, y, test_size=0.2, random_state=42
    )

    print("--- KÃ­ch thÆ°á»›c sau khi chia ---")
    print(f"KÃ­ch thÆ°á»›c X_train: {X_train.shape}")
    print(f"KÃ­ch thÆ°á»›c X_test: {X_test.shape}")


    # --- 2. Xá»­ lÃ½ GiÃ¡ trá»‹ thiáº¿u ---
    print("\n--- GiÃ¡ trá»‹ thiáº¿u TRÆ¯á»šC khi xá»­ lÃ½ (trÃªn táº­p train) ---")
    print(X_train.isnull().sum())

    # Chiáº¿n lÆ°á»£c: Äiá»n giÃ¡ trá»‹ thiáº¿u cho cá»™t 'Age' báº±ng TRUNG Vá»Š
    # Ta tÃ­nh trung vá»‹ trÃªn táº­p train Äá»‚ TRÃNH RÃ’ Rá»ˆ Dá»® LIá»†U
    median_age = X_train['Age'].median()
    print(f"\nTuá»•i trung vá»‹ trÃªn táº­p train: {median_age:.2f}")

    # Ãp dá»¥ng Ä‘iá»n giÃ¡ trá»‹ cho cáº£ táº­p train vÃ  táº­p test
    # inplace=True Ä‘á»ƒ thay Ä‘á»•i trá»±c tiáº¿p trÃªn DataFrame
    X_train['Age'].fillna(median_age, inplace=True)
    X_test['Age'].fillna(median_age, inplace=True) 

    print("\n--- GiÃ¡ trá»‹ thiáº¿u SAU khi xá»­ lÃ½ (trÃªn táº­p train) ---")
    print(X_train.isnull().sum())

---

### **Tháº£o luáº­n NÃ¢ng cao & CÃ¡c "Cáº¡m báº«y"**

* **RÃ² rá»‰ Dá»¯ liá»‡u (Data Leakage):** Má»™t trong nhá»¯ng sai láº§m nghiÃªm trá»ng nháº¥t. **Báº¡n pháº£i luÃ´n thá»±c hiá»‡n Train-Test Split TRÆ¯á»šC khi lÃ m báº¥t cá»© viá»‡c gÃ¬ khÃ¡c.** VÃ­ dá»¥, náº¿u báº¡n tÃ­nh tuá»•i trung bÃ¬nh trÃªn toÃ n bá»™ bá»™ dá»¯ liá»‡u rá»“i má»›i chia, thÃ¬ thÃ´ng tin tá»« táº­p test (tuá»•i cá»§a hÃ nh khÃ¡ch trong táº­p test) Ä‘Ã£ bá»‹ "rÃ² rá»‰" vÃ o quÃ¡ trÃ¬nh tiá»n xá»­ lÃ½ cá»§a táº­p train. Äiá»u nÃ y lÃ m cho káº¿t quáº£ Ä‘Ã¡nh giÃ¡ cá»§a báº¡n trá»Ÿ nÃªn láº¡c quan má»™t cÃ¡ch giáº£ táº¡o.

---

### **âœï¸ BÃ i thá»±c hÃ nh:**

Sá»­ dá»¥ng cÃ¡c táº­p `X_train`, `X_test` Ä‘Ã£ Ä‘Æ°á»£c xá»­ lÃ½ á»Ÿ trÃªn.

1.  **PhÃ¢n tÃ­ch Cá»™t `Embarked`:**
    * Cá»™t `Embarked` (Cáº£ng lÃªn tÃ u) cÃ³ má»™t vÃ i giÃ¡ trá»‹ bá»‹ thiáº¿u.
    * HÃ£y kiá»ƒm tra xem giÃ¡ trá»‹ nÃ o lÃ  **mode** (giÃ¡ trá»‹ xuáº¥t hiá»‡n nhiá»u nháº¥t) cá»§a cá»™t `Embarked` trong táº­p **`X_train`**.
    * Viáº¿t code Ä‘á»ƒ Ä‘iá»n cÃ¡c giÃ¡ trá»‹ thiáº¿u trong cáº£ `X_train` vÃ  `X_test` báº±ng giÃ¡ trá»‹ mode báº¡n vá»«a tÃ¬m Ä‘Æ°á»£c.

2.  **PhÃ¢n tÃ­ch Cá»™t `Cabin`:**
    * Nháº­n xÃ©t vá» sá»‘ lÆ°á»£ng giÃ¡ trá»‹ thiáº¿u trong cá»™t `Cabin`.
    * Vá»›i má»™t cá»™t cÃ³ tá»· lá»‡ thiáº¿u cao nhÆ° váº­y, chiáº¿n lÆ°á»£c **xÃ³a cá»™t** cÃ³ pháº£i lÃ  má»™t lá»±a chá»n há»£p lÃ½ khÃ´ng? Táº¡i sao? Viáº¿t code Ä‘á»ƒ xÃ³a cá»™t `Cabin` khá»i cáº£ `X_train` vÃ  `X_test`. **Gá»£i Ã½:** dÃ¹ng `df.drop('ten_cot', axis=1, inplace=True)`.