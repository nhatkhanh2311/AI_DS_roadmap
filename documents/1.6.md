# Giai đoạn 1: Nền tảng Python & Lập trình
## Bài 1.6: Tương tác với File (File I/O)

### **🎯 Mục tiêu bài học:**
1.  Học cách **đọc (read)** nội dung từ các file văn bản.
2.  Học cách **ghi (write)** và **ghi nối (append)** nội dung vào file.
3.  Hiểu và sử dụng câu lệnh `with open()` - cách làm việc với file an toàn và được khuyến khích nhất.

---

### **1. Cách làm việc với File được khuyến khích: `with open()`**

Cách tốt nhất để mở một file trong Python là sử dụng câu lệnh `with`.

    with open('ten_file.txt', 'mode') as file_variable:
        # Làm việc với file ở đây

* **Tại sao nên dùng `with`?** Nó đảm bảo file sẽ được **tự động đóng lại** một cách chính xác sau khi bạn làm việc xong, ngay cả khi có lỗi xảy ra trong quá trình xử lý. Điều này giúp tránh các lỗi rò rỉ tài nguyên.

* **`mode` (chế độ mở file):** Là một chuỗi ký tự quy định cách bạn muốn tương tác với file. Các mode phổ biến nhất là:
    * `'r'` : **Read** - Mở file để đọc (đây là chế độ mặc định). Báo lỗi nếu file không tồn tại.
    * `'w'` : **Write** - Mở file để ghi. Nếu file đã tồn tại, **nội dung cũ sẽ bị xóa hoàn toàn**. Nếu file chưa tồn tại, nó sẽ được tạo mới.
    * `'a'` : **Append** - Mở file để ghi nối. Nội dung mới sẽ được ghi vào **cuối** file đã có. Nếu file chưa tồn tại, nó sẽ được tạo mới.

---

### **2. Đọc nội dung từ File (Reading)**

Giả sử chúng ta có một file tên là `data.txt` với nội dung sau:

```text
Dòng đầu tiên.
Dòng thứ hai.
Dòng cuối cùng.
```

    # Mở file data.txt ở chế độ đọc ('r')
    try:
        with open('data.txt', 'r', encoding='utf-8') as f:
            # Cách 1: Đọc toàn bộ nội dung file vào một chuỗi duy nhất
            # content = f.read()
            # print(content)
            
            # Cách 2: Đọc file theo từng dòng (cách hiệu quả và phổ biến nhất)
            print("Đọc file theo từng dòng:")
            for line in f:
                # .strip() dùng để xóa các khoảng trắng thừa và ký tự xuống dòng `\n` ở đầu và cuối dòng
                print(line.strip())
    except FileNotFoundError:
        print("Lỗi: Không tìm thấy file data.txt!")


* **Lưu ý:** `encoding='utf-8'` rất quan trọng khi làm việc với file có chứa tiếng Việt để đảm bảo ký tự được đọc và ghi một cách chính xác.

---

### **3. Ghi nội dung vào File (Writing & Appending)**

#### **a. Chế độ `'w'` (Write) - Ghi đè**

**Cảnh báo:** Chế độ này sẽ xóa sạch nội dung cũ của file.

    # Mở file 'output.txt' ở chế độ ghi ('w')
    lines_to_write = ["Kết quả phân tích 1\n", "Kết quả phân tích 2\n"]

    with open('output.txt', 'w', encoding='utf-8') as f:
        f.write("Báo cáo kết quả:\n") # Ghi một chuỗi
        f.writelines(lines_to_write) # Ghi một danh sách các chuỗi

    print("Đã ghi xong vào file output.txt (ghi đè).")
    # Bây giờ hãy mở file output.txt để xem nội dung.

#### **b. Chế độ `'a'` (Append) - Ghi nối**

Chế độ này an toàn hơn, nó chỉ thêm nội dung mới vào cuối file.

    # Mở lại file 'output.txt' ở chế độ ghi nối ('a')
    with open('output.txt', 'a', encoding='utf-8') as f:
        f.write("Bổ sung kết luận.\n")

    print("Đã ghi nối thêm vào file output.txt.")
    # Mở lại file output.txt để thấy dòng mới đã được thêm vào cuối.

---

### **4. Làm việc với các định dạng khác (CSV, JSON)**

Các file `.csv` (dữ liệu dạng bảng) và `.json` (dữ liệu có cấu trúc) cũng là các file văn bản. Tuy nhiên, để làm việc với chúng một cách hiệu quả, chúng ta sẽ sử dụng các thư viện chuyên dụng như **Pandas** (cho CSV) và **json** (cho JSON) ở các giai đoạn sau. Nguyên tắc `open/read/write` vẫn là nền tảng.

---

### **✍️ Bài thực hành:**

1.  **Viết và Bổ sung Nhật ký:**
    * **Bước 1:** Viết một chương trình tạo ra file `my_diary.txt`. Mở file này ở chế độ **ghi (`'w'`)** và ghi vào đó 2 dòng nhật ký cho ngày hôm nay. (Nhớ thêm `\n` để xuống dòng).
    * **Bước 2:** Viết tiếp một đoạn chương trình khác (hoặc chạy lại chương trình), lần này mở file `my_diary.txt` ở chế độ **ghi nối (`'a'`)** và ghi thêm một dòng nhật ký nữa.
    * **Mục đích:** Để bạn tự mình thấy rõ sự khác biệt giữa `'w'` và `'a'`.

2.  **Đọc và Phân tích File:**
    * Viết một chương trình đọc file `my_diary.txt` mà bạn vừa tạo.
    * Chương trình cần đếm và in ra màn hình 2 thông tin:
        * Tổng số dòng có trong file.
        * Tổng số từ có trong toàn bộ file.
    * **Gợi ý:** Để đếm từ, bạn có thể đọc từng dòng, dùng hàm `.split()` để tách dòng đó thành một danh sách các từ, rồi dùng `len()` để lấy số lượng từ trong danh sách đó.