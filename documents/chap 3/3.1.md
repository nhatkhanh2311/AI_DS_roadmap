# Giai đoạn 3: Thu thập và Quản lý Dữ liệu
## Bài 3.1: SQL (Phần 1) - Truy vấn & Lọc Dữ liệu

### **🎯 Mục tiêu bài học:**
1.  Hiểu vai trò của PostgreSQL như một hệ quản trị CSDL Client-Server.
2.  Sử dụng DataGrip để tương tác với CSDL PostgreSQL của bạn.
3.  Nắm vững cú pháp của các câu lệnh truy vấn cốt lõi: **`SELECT`**, **`FROM`**, **`WHERE`**.
4.  Lọc dữ liệu bằng các toán tử và sắp xếp, giới hạn kết quả trả về.

---

### **1. Môi trường Làm việc: PostgreSQL + DataGrip**

Chúng ta đã thiết lập một môi trường chuyên nghiệp:
* **PostgreSQL Server:** Là "trái tim", một chương trình chạy nền trên máy tính của bạn, có nhiệm vụ lưu trữ và quản lý toàn bộ dữ liệu.
* **DataGrip:** Là "bộ điều khiển" của bạn. Nó là một client, một công cụ đồ họa giúp bạn gửi các câu lệnh SQL đến server và nhận lại kết quả một cách trực quan.

**Analogy:** Hãy coi PostgreSQL Server là một nhà kho dữ liệu khổng lồ. DataGrip là chiếc máy tính bảng bạn cầm trên tay để gửi yêu cầu đến người quản kho. **SQL** chính là ngôn ngữ bạn gõ vào máy tính bảng đó.

---

### **2. Chuẩn bị Dữ liệu trong DataGrip**

Trước khi thực hành, chúng ta cần tạo bảng và dữ liệu.

* **Bước 1: Mở Console:** Trong DataGrip, hãy đảm bảo bạn đang mở một cửa sổ truy vấn mới (Query Console) kết nối đến CSDL `postgres` của bạn.
* **Bước 2: Chạy Script Tạo Bảng:** Sao chép toàn bộ đoạn code dưới đây, dán vào console và chạy nó (nhấn nút "Execute" hình tam giác màu xanh).

        -- Xóa bảng nếu nó đã tồn tại để tránh lỗi khi chạy lại
        DROP TABLE IF EXISTS Employees;

        -- Tạo bảng Employees
        CREATE TABLE Employees (
            ID INT PRIMARY KEY,
            Name VARCHAR(100),
            Department VARCHAR(50),
            Salary INT,
            HireDate DATE
        );

        -- Chèn dữ liệu mẫu
        INSERT INTO Employees (ID, Name, Department, Salary, HireDate) VALUES
        (1, 'John Smith', 'Sales', 60000, '2022-01-15'),
        (2, 'Jane Doe', 'Marketing', 75000, '2021-09-20'),
        (3, 'Peter Jones', 'Sales', 55000, '2022-03-10'),
        (4, 'Mary Johnson', 'HR', 80000, '2020-11-05'),
        (5, 'James Brown', 'IT', 95000, '2021-05-30'),
        (6, 'Patricia Williams', 'IT', 105000, '2022-08-21'),
        (7, 'Robert Davis', 'Marketing', 72000, '2023-01-18');

* **Bước 3: Kiểm tra:** Sau khi chạy, bạn có thể làm mới (refresh) schema ở thanh bên trái của DataGrip và sẽ thấy bảng `employees` xuất hiện.

---

### **3. Các Câu lệnh SQL Cơ bản**

Bây giờ, hãy xóa đoạn code trên và bắt đầu viết các câu truy vấn của riêng bạn trong console.

#### **a. `SELECT` và `FROM`**
* **`SELECT *`**: Lấy **tất cả các cột**.
* **`SELECT ten_cot1, ten_cot2`**: Chỉ lấy các cột cụ thể.
* **`FROM Employees`**: Chỉ định rằng chúng ta đang làm việc trên bảng `Employees`.

        -- Ví dụ: Lấy tất cả thông tin từ bảng Employees
        SELECT * FROM Employees;

        -- Ví dụ: Chỉ lấy tên và lương
        SELECT Name, Salary FROM Employees;

#### **b. Lọc hàng với `WHERE`**
Mệnh đề `WHERE` được đặt sau `FROM` để lọc ra những hàng thỏa mãn điều kiện.

        -- Lấy tất cả thông tin của nhân viên thuộc phòng 'Sales'
        SELECT * FROM Employees
        WHERE Department = 'Sales';

        -- Lấy nhân viên phòng IT có lương trên 100000
        SELECT * FROM Employees
        WHERE Department = 'IT' AND Salary > 100000;

#### **c. Sắp xếp với `ORDER BY` và Giới hạn với `LIMIT`**
* **`ORDER BY ten_cot DESC`**: Sắp xếp giảm dần.
* **`ORDER BY ten_cot ASC`**: Sắp xếp tăng dần (mặc định).
* **`LIMIT so_luong`**: Chỉ lấy `so_luong` hàng đầu tiên.

        -- Tìm 3 nhân viên có lương cao nhất
        SELECT Name, Salary
        FROM Employees
        ORDER BY Salary DESC
        LIMIT 3;

---

### **✍️ Bài thực hành:**

Hãy viết và chạy các câu lệnh SQL trong **DataGrip** để trả lời những câu hỏi sau:

1.  Lấy ra **tên** và **lương** của tất cả nhân viên thuộc phòng **'IT'**.
2.  Lấy ra **tất cả thông tin** của những nhân viên được tuyển dụng **sau ngày '2022-01-01'**.
3.  Lấy ra **tên** và **ngày tuyển dụng** của những nhân viên có mức lương nằm trong khoảng từ **70000 đến 85000**. **Gợi ý:** dùng toán tử `BETWEEN`.
4.  Lấy ra thông tin của 3 nhân viên được tuyển dụng gần đây nhất (dựa vào `HireDate`).