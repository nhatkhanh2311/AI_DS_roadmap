# Giai đoạn 2: Nền tảng Toán & Thống kê
## Bài 2.9: Nền tảng Thống kê Suy luận (Inferential Statistics)

### **🎯 Mục tiêu bài học:**
1.  Phân biệt giữa **Quần thể (Population)** và **Mẫu (Sample)**.
2.  Hiểu khái niệm cốt lõi của **Kiểm định giả thuyết (Hypothesis Testing)**.
3.  Nắm vững ý nghĩa và cách diễn giải **p-value**.
4.  Làm quen với một ví dụ kiểm định thống kê phổ biến: **T-test**.

---

### **1. Quần thể và Mẫu**

* **Quần thể (Population):** Là toàn bộ tập hợp các đối tượng mà chúng ta quan tâm.
    * *Ví dụ:* Tất cả các cử tri ở Việt Nam.
* **Mẫu (Sample):** Là một tập hợp con được chọn ra từ quần thể.
    * *Ví dụ:* 1000 cử tri được chọn ngẫu nhiên để khảo sát.

Trong thực tế, chúng ta không bao giờ có thể thu thập dữ liệu từ toàn bộ quần thể. Thay vào đó, chúng ta thu thập dữ liệu từ một mẫu và dùng **Thống kê Suy luận** để rút ra các kết luận về quần thể đó.

---

### **2. Kiểm định Giả thuyết (Hypothesis Testing) 🧐**

Đây là một quy trình có cấu trúc để đưa ra quyết định về một tuyên bố (giả thuyết) về quần thể, dựa trên bằng chứng từ dữ liệu mẫu.

Quy trình này luôn bắt đầu với hai giả thuyết đối lập nhau:

* **Giả thuyết không (Null Hypothesis - $H_0$):**
    * Là một tuyên bố mặc định, thường cho rằng **"không có gì xảy ra"**, "không có sự khác biệt", hoặc "không có mối liên hệ".
    * *Ví dụ:* $H_0$: "Không có sự khác biệt về chiều cao trung bình giữa nam và nữ."

* **Giả thuyết đối (Alternative Hypothesis - $H_1$ hoặc $H_a$):**
    * Là tuyên bố mà chúng ta muốn chứng minh. Nó phủ định lại giả thuyết không.
    * *Ví dụ:* $H_1$: "Có sự khác biệt về chiều cao trung bình giữa nam và nữ."

Mục tiêu của chúng ta là thu thập bằng chứng từ mẫu để xem liệu chúng ta có đủ cơ sở để **bác bỏ giả thuyết không ($H_0$)** hay không.

---

### **3. p-value là gì?**

**p-value** là một trong những khái niệm quan trọng nhưng cũng dễ bị hiểu nhầm nhất trong thống kê.

* **Định nghĩa:** **p-value** là xác suất quan sát được một kết quả **ít nhất là khác biệt như** kết quả thực tế trong mẫu của bạn, **giả sử rằng giả thuyết không ($H_0$) là đúng**.

* **Diễn giải một cách đơn giản:**
    * **p-value nhỏ (thường < 0.05):** Điều này có nghĩa là: "Nếu giả thuyết không là đúng (ví dụ: thực sự không có sự khác biệt), thì việc quan sát được sự khác biệt lớn như thế này trong mẫu của chúng ta là rất khó xảy ra (rất hiếm)." Do đó, chúng ta có đủ bằng chứng để **bác bỏ giả thuyết không** và chấp nhận giả thuyết đối. Kết quả này được gọi là **có ý nghĩa thống kê (statistically significant)**.
    * **p-value lớn (thường >= 0.05):** Điều này có nghĩa là: "Nếu giả thuyết không là đúng, thì sự khác biệt mà chúng ta thấy trong mẫu cũng không có gì lạ, nó hoàn toàn có thể xảy ra do ngẫu nhiên." Do đó, chúng ta **không đủ bằng chứng để bác bỏ giả thuyết không**.

---

### **4. Ví dụ: Independent T-test**

**T-test** là một loại kiểm định thống kê dùng để so sánh giá trị trung bình của hai nhóm.

**Bài toán:** Chúng ta muốn biết liệu giá vé (`Fare`) mà hành khách nam và nữ trên tàu Titanic trả có thực sự khác nhau hay không, hay sự khác biệt chúng ta thấy chỉ là do ngẫu nhiên.

* **Giả thuyết không ($H_0$):** Giá vé trung bình của nam và nữ là bằng nhau.
* **Giả thuyết đối ($H_1$):** Giá vé trung bình của nam và nữ là khác nhau.

Chúng ta sẽ dùng `scipy.stats` để thực hiện kiểm định này.

    import pandas as pd
    from scipy.stats import ttest_ind

    df = pd.read_csv('titanic.csv')

    # Tạo hai mẫu dữ liệu: giá vé của nam và giá vé của nữ
    # .dropna() để loại bỏ các giá trị thiếu
    male_fares = df[df['Sex'] == 'male']['Fare'].dropna()
    female_fares = df[df['Sex'] == 'female']['Fare'].dropna()

    # Thực hiện Independent T-test
    t_statistic, p_value = ttest_ind(male_fares, female_fares)

    print("--- Kết quả T-test cho Giá vé giữa Nam và Nữ ---")
    print(f"T-statistic: {t_statistic:.4f}")
    print(f"P-value: {p_value:.4f}")

    # Diễn giải kết quả
    alpha = 0.05 # Mức ý nghĩa
    if p_value < alpha:
        print("\nKết luận: P-value < 0.05, chúng ta bác bỏ giả thuyết không.")
        print("=> Có sự khác biệt có ý nghĩa thống kê về giá vé giữa nam và nữ.")
    else:
        print("\nKết luận: P-value >= 0.05, chúng ta không đủ bằng chứng để bác bỏ giả thuyết không.")
        print("=> Không có sự khác biệt có ý nghĩa thống kê về giá vé giữa nam và nữ.")

**Phân tích Output:** Kết quả `p_value` sẽ rất nhỏ (thường là nhỏ hơn 0.0001). Điều này cho phép chúng ta tự tin kết luận rằng sự khác biệt về giá vé trung bình giữa hai giới không phải là ngẫu nhiên.

---

### **✍️ Bài thực hành:**

1.  **Phát biểu Giả thuyết:**
    * Bạn muốn kiểm tra xem liệu tuổi trung bình (`Age`) của những người sống sót (`Survived` = 1) có khác với tuổi trung bình của những người tử vong (`Survived` = 0) trên tàu Titanic hay không.
    * Hãy phát biểu **Giả thuyết không ($H_0$)** và **Giả thuyết đối ($H_1$)** cho bài toán này.

2.  **Thực hiện T-test:**
    * Sử dụng `pandas` để tạo ra hai mẫu dữ liệu: một chứa tuổi của những người sống sót, một chứa tuổi của những người tử vong. Đừng quên loại bỏ các giá trị tuổi bị thiếu (`.dropna()`).
    * Sử dụng hàm `ttest_ind` từ `scipy.stats` để thực hiện kiểm định T-test trên hai mẫu này.
    * In ra giá trị `p-value`.

3.  **Rút ra Kết luận:**
    * Dựa trên `p-value` bạn nhận được và mức ý nghĩa `alpha = 0.05`, bạn sẽ bác bỏ hay không bác bỏ giả thuyết không?
    * Viết một câu kết luận đầy đủ về mối quan hệ giữa tuổi tác và khả năng sống sót.