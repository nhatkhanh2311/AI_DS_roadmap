# Giai đoạn 2: Nền tảng Toán & Thống kê
## Bài 2.5: Nền tảng Giải tích cho Tối ưu hóa

### **🎯 Mục tiêu bài học:**
1.  Hiểu ý nghĩa trực quan của **Đạo hàm (Derivative)** là "độ dốc" hoặc "tốc độ thay đổi".
2.  Mở rộng khái niệm sang hàm nhiều biến với **Đạo hàm riêng (Partial Derivative)**.
3.  Nắm vững khái niệm **Vector Gradient (∇f)**, vector chỉ hướng dốc nhất của hàm số.
4.  Hiểu vai trò của Giải tích trong việc tìm điểm cực tiểu của hàm mất mát.

---

### **1. Ý nghĩa trực quan của Đạo hàm**

Hãy tưởng tượng bạn đang đi trên một ngọn núi. Tại bất kỳ điểm nào bạn đứng, **độ dốc** của sườn núi ngay tại đó chính là đạo hàm.

* **Đạo hàm dương:** Bạn đang đi lên dốc.
* **Đạo hàm âm:** Bạn đang đi xuống dốc.
* **Đạo hàm bằng 0:** Bạn đang ở một nơi bằng phẳng (có thể là đỉnh núi, đáy thung lũng, hoặc một điểm yên ngựa).

Trong Machine Learning, chúng ta muốn tìm "đáy thung lũng" của **hàm mất mát (loss function)** - nơi mà sai số của mô hình là nhỏ nhất. Đạo hàm chính là công cụ giúp chúng ta biết phải đi theo hướng nào để xuống dốc. 

---

### **2. Đạo hàm riêng (Partial Derivatives)**

Thực tế, hàm mất mát của chúng ta không phụ thuộc vào một biến duy nhất, mà phụ thuộc vào hàng nghìn, thậm chí hàng triệu biến (các trọng số của mô hình). Khi đó, chúng ta cần **Đạo hàm riêng**.

Đạo hàm riêng của một hàm nhiều biến (ví dụ: $f(x, y)$) theo một biến (ví dụ: $x$) được tính bằng cách coi tất cả các biến khác (ở đây là $y$) như những **hằng số**.

* **Ký hiệu:** $\frac{\partial f}{\partial x}$ (đạo hàm riêng của f theo x).
* **Ý nghĩa:** Nó cho biết "độ dốc" của hàm số nếu chúng ta chỉ di chuyển theo **hướng của trục x**.

**Ví dụ:** Cho hàm $f(x, y) = 3x^2 + 2xy + y^2$
* Để tính $\frac{\partial f}{\partial x}$, ta coi `y` là hằng số:
    $\frac{\partial f}{\partial x} = 6x + 2y + 0 = 6x + 2y$
* Để tính $\frac{\partial f}{\partial y}$, ta coi `x` là hằng số:
    $\frac{\partial f}{\partial y} = 0 + 2x + 2y = 2x + 2y$

---

### **3. Vector Gradient (∇f) 🏔️**

**Gradient** là một vector chứa tất cả các đạo hàm riêng của hàm số.
$$\nabla f = \begin{bmatrix} \frac{\partial f}{\partial x_1} \\ \frac{\partial f}{\partial x_2} \\ \vdots \\ \frac{\partial f}{\partial x_n} \end{bmatrix}$$

**Tính chất quan trọng nhất:** Vector Gradient tại một điểm bất kỳ luôn **chỉ về hướng dốc nhất** (hướng làm cho giá trị của hàm số tăng nhanh nhất) tại điểm đó.

**Kết nối với tối ưu hóa:** Nếu Gradient chỉ về hướng dốc lên, thì **âm của Gradient (-∇f)** sẽ chỉ về **hướng dốc xuống nhanh nhất**. Đây chính là nguyên lý cốt lõi của thuật toán **Gradient Descent** mà chúng ta sẽ tìm hiểu kỹ hơn sau này.

---

### **4. Tính toán Đạo hàm với SymPy**

`SymPy` là một thư viện Python cho tính toán biểu tượng, rất hữu ích để kiểm tra các phép tính đạo hàm.

    from sympy import symbols, diff

    # 1. Khai báo các biến (biểu tượng)
    x, y = symbols('x y')

    # 2. Định nghĩa hàm số
    f = 3*x**2 + 2*x*y + y**2

    # 3. Tính đạo hàm riêng
    df_dx = diff(f, x) # Đạo hàm f theo x
    df_dy = diff(f, y) # Đạo hàm f theo y

    print("--- Tính đạo hàm với SymPy ---")
    print(f"Hàm số f(x, y) = {f}")
    print(f"Đạo hàm riêng theo x: {df_dx}") # Output: 6*x + 2*y
    print(f"Đạo hàm riêng theo y: {df_dy}") # Output: 2*x + 2*y

---

### **✍️ Bài thực hành:**

1.  **Tính đạo hàm bằng tay:**
    * Cho hàm số: $f(x, y) = x^3 - 4x^2y + 5y^2$.
    * Hãy tính đạo hàm riêng $\frac{\partial f}{\partial x}$ và $\frac{\partial f}{\partial y}$ bằng tay trên giấy.

2.  **Kiểm tra với SymPy:**
    * Sử dụng thư viện `SymPy` để tính lại hai đạo hàm riêng ở bài 1 và kiểm tra xem kết quả của bạn có đúng không.

3.  **Tính toán Gradient:**
    * Cho hàm số $g(w, b) = (w \cdot 2 + b - 5)^2$. Đây là một dạng hàm mất mát rất đơn giản (sai số bình phương).
    * Hãy tính **Vector Gradient** $\nabla g$ của hàm số này tại điểm $(w=3, b=1)$.
    * **Các bước:**
        * a. Tính đạo hàm riêng $\frac{\partial g}{\partial w}$ và $\frac{\partial g}{\partial b}$ bằng tay.
        * b. Thế giá trị `w=3` và `b=1` vào các công thức đạo hàm riêng bạn vừa tìm được để ra kết quả cuối cùng.