# Giai ƒëo·∫°n 2: N·ªÅn t·∫£ng To√°n & Th·ªëng k√™
## B√†i 2.7: Nh·∫≠p m√¥n Thao t√°c D·ªØ li·ªáu v·ªõi Pandas

### **üéØ M·ª•c ti√™u b√†i h·ªçc:**
1.  Hi·ªÉu hai c·∫•u tr√∫c d·ªØ li·ªáu c·ªët l√µi c·ªßa Pandas: **Series** v√† **DataFrame**.
2.  H·ªçc c√°ch ƒë·ªçc d·ªØ li·ªáu t·ª´ file (v√≠ d·ª•: CSV) v√†o m·ªôt DataFrame.
3.  Th·ª±c hi·ªán c√°c thao t√°c c∆° b·∫£n: xem, ch·ªçn, v√† l·ªçc d·ªØ li·ªáu.
4.  X·ª≠ l√Ω c√°c v·∫•n ƒë·ªÅ d·ªØ li·ªáu ph·ªï bi·∫øn nh∆∞ gi√° tr·ªã thi·∫øu.

---

### **1. Gi·ªõi thi·ªáu Pandas üêº**

Pandas l√† m·ªôt th∆∞ vi·ªán m√£ ngu·ªìn m·ªü, hi·ªáu su·∫•t cao, cung c·∫•p c√°c c·∫•u tr√∫c d·ªØ li·ªáu v√† c√¥ng c·ª• ph√¢n t√≠ch d·ªØ li·ªáu d·ªÖ s·ª≠ d·ª•ng. N√≥ l√† c√¥ng c·ª• kh√¥ng th·ªÉ thi·∫øu c·ªßa b·∫•t k·ª≥ nh√† khoa h·ªçc d·ªØ li·ªáu n√†o l√†m vi·ªác v·ªõi Python.

#### **a. Series**
M·ªôt **Series** l√† m·ªôt m·∫£ng 1 chi·ªÅu gi·ªëng nh∆∞ vector c·ªßa NumPy, nh∆∞ng c√≥ th√™m m·ªôt th·ª© g·ªçi l√† **index** (ch·ªâ s·ªë). Index cho ph√©p b·∫°n truy c·∫≠p c√°c ph·∫ßn t·ª≠ b·∫±ng nh√£n thay v√¨ ch·ªâ b·∫±ng v·ªã tr√≠ s·ªë.

    import pandas as pd

    # T·∫°o m·ªôt Series t·ª´ list
    s = pd.Series([10, 20, 30], index=['a', 'b', 'c'])
    print("--- M·ªôt Pandas Series ---")
    print(s)
    
    # Truy c·∫≠p b·∫±ng index
    print(f"\nGi√° tr·ªã t·∫°i index 'b' l√†: {s['b']}")

#### **b. DataFrame**
M·ªôt **DataFrame** l√† m·ªôt c·∫•u tr√∫c d·ªØ li·ªáu 2 chi·ªÅu d·∫°ng b·∫£ng, gi·ªëng nh∆∞ m·ªôt b·∫£ng t√≠nh Excel ho·∫∑c m·ªôt b·∫£ng trong SQL. N√≥ c√≥ c·∫£ index cho h√†ng v√† t√™n cho c·ªôt.

B·∫°n c√≥ th·ªÉ coi m·ªôt DataFrame nh∆∞ m·ªôt t·∫≠p h·ª£p c√°c **Series** c√≥ chung m·ªôt index. 

---

### **2. ƒê·ªçc v√† Xem D·ªØ li·ªáu**

Trong th·ª±c t·∫ø, b·∫°n s·∫Ω hi·∫øm khi t·ª± t·∫°o DataFrame m√† th∆∞·ªùng ƒë·ªçc n√≥ t·ª´ m·ªôt file. Ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng m·ªôt file v√≠ d·ª• l√† `titanic.csv`.

    # ƒê·ªçc d·ªØ li·ªáu t·ª´ file CSV v√†o m·ªôt DataFrame
    # Gi·∫£ s·ª≠ file 'titanic.csv' n·∫±m c√πng th∆∞ m·ª•c
    try:
        df = pd.read_csv('titanic.csv')

        # Xem 5 d√≤ng ƒë·∫ßu ti√™n c·ªßa DataFrame
        print("\n--- 5 d√≤ng ƒë·∫ßu c·ªßa b·ªô d·ªØ li·ªáu Titanic ---")
        print(df.head())

        # Xem th√¥ng tin t·ªïng quan v·ªÅ DataFrame
        print("\n--- Th√¥ng tin t·ªïng quan (info) ---")
        df.info()

        # Xem c√°c th·ªëng k√™ m√¥ t·∫£ c∆° b·∫£n cho c√°c c·ªôt s·ªë
        print("\n--- Th·ªëng k√™ m√¥ t·∫£ (describe) ---")
        print(df.describe())

    except FileNotFoundError:
        print("L·ªói: Kh√¥ng t√¨m th·∫•y file 'titanic.csv'.")
        print("B·∫°n c√≥ th·ªÉ t·∫£i n√≥ t·ª´: https://www.kaggle.com/datasets/hesh97/titanicdataset-traincsv")

---

### **3. L·ª±a ch·ªçn v√† L·ªçc D·ªØ li·ªáu (Selection & Filtering)**

ƒê√¢y l√† nh·ªØng thao t√°c b·∫°n s·∫Ω th·ª±c hi·ªán h√†ng ng√†y.

#### **a. Ch·ªçn C·ªôt**

    # Ch·ªçn m·ªôt c·ªôt duy nh·∫•t (k·∫øt qu·∫£ l√† m·ªôt Series)
    ages = df['Age']

    # Ch·ªçn nhi·ªÅu c·ªôt (k·∫øt qu·∫£ l√† m·ªôt DataFrame)
    subset = df[['Name', 'Age', 'Sex']]
    print("\n--- Ch·ªçn c√°c c·ªôt Name, Age, Sex ---")
    print(subset.head())

#### **b. L·ªçc H√†ng theo ƒëi·ªÅu ki·ªán**

C√∫ ph√°p n√†y r·∫•t tr·ª±c quan, gi·ªëng nh∆∞ m·ªôt c√¢u l·ªánh `WHERE` trong SQL.

    # 1. T·∫°o m·ªôt ƒëi·ªÅu ki·ªán logic
    condition = df['Age'] > 30

    # 2. D√πng ƒëi·ªÅu ki·ªán ƒë√≥ ƒë·ªÉ l·ªçc DataFrame
    above_30 = df[condition]
    print("\n--- C√°c h√†nh kh√°ch tr√™n 30 tu·ªïi ---")
    print(above_30.head())

    # K·∫øt h·ª£p nhi·ªÅu ƒëi·ªÅu ki·ªán
    # D√πng `&` cho AND, `|` cho OR, `~` cho NOT
    # M·ªói ƒëi·ªÅu ki·ªán ph·∫£i n·∫±m trong d·∫•u ngo·∫∑c ƒë∆°n
    survived_women = df[(df['Sex'] == 'female') & (df['Survived'] == 1)]
    print("\n--- C√°c h√†nh kh√°ch n·ªØ ƒë√£ s·ªëng s√≥t ---")
    print(survived_women.head())

---

### **4. X·ª≠ l√Ω D·ªØ li·ªáu thi·∫øu**

D·ªØ li·ªáu trong th·∫ø gi·ªõi th·ª±c hi·∫øm khi ho√†n h·∫£o. `df.info()` ·ªü tr√™n cho th·∫•y c·ªôt `Age` c√≥ nhi·ªÅu gi√° tr·ªã b·ªã thi·∫øu (non-null √≠t h∆°n t·ªïng s·ªë entries).

    # ƒê·∫øm s·ªë l∆∞·ª£ng gi√° tr·ªã thi·∫øu trong m·ªói c·ªôt
    print("\n--- S·ªë l∆∞·ª£ng gi√° tr·ªã thi·∫øu ---")
    print(df.isnull().sum())

    # M·ªôt c√°ch x·ª≠ l√Ω ƒë∆°n gi·∫£n l√† ƒëi·ªÅn gi√° tr·ªã thi·∫øu b·∫±ng m·ªôt gi√° tr·ªã kh√°c
    # V√≠ d·ª•: ƒëi·ªÅn tu·ªïi b·ªã thi·∫øu b·∫±ng tu·ªïi trung b√¨nh
    mean_age = df['Age'].mean()
    df_filled = df.copy() # T·∫°o b·∫£n sao ƒë·ªÉ kh√¥ng ·∫£nh h∆∞·ªüng df g·ªëc
    df_filled['Age'].fillna(mean_age, inplace=True)

    # Ki·ªÉm tra l·∫°i
    print("\n--- S·ªë l∆∞·ª£ng gi√° tr·ªã thi·∫øu ·ªü c·ªôt Age sau khi ƒëi·ªÅn ---")
    print(df_filled['Age'].isnull().sum()) # Output: 0

---

### **‚úçÔ∏è B√†i th·ª±c h√†nh:**

S·ª≠ d·ª•ng DataFrame `titanic` ƒë√£ ƒë∆∞·ª£c load ·ªü tr√™n ƒë·ªÉ tr·∫£ l·ªùi c√°c c√¢u h·ªèi sau:

1.  **L·ªçc d·ªØ li·ªáu:**
    * T·∫°o m·ªôt DataFrame m·ªõi t√™n l√† `class1_passengers` ch·ªâ ch·ª©a nh·ªØng h√†nh kh√°ch ƒëi ·ªü khoang h·∫°ng nh·∫•t (`Pclass` == 1).
    * T·ª´ DataFrame `class1_passengers` ƒë√≥, c√≥ bao nhi√™u ng∆∞·ªùi ƒë√£ s·ªëng s√≥t (`Survived` == 1)? In ra s·ªë l∆∞·ª£ng.

2.  **T·∫°o c·ªôt m·ªõi (Feature Engineering):**
    * T·∫°o m·ªôt c·ªôt m·ªõi trong DataFrame `df` t√™n l√† `FamilySize`. Gi√° tr·ªã c·ªßa n√≥ ƒë∆∞·ª£c t√≠nh b·∫±ng t·ªïng c·ªßa hai c·ªôt `SibSp` (s·ªë anh ch·ªã em/v·ª£ ch·ªìng) v√† `Parch` (s·ªë cha m·∫π/con c√°i) c·ªông v·ªõi 1 (ch√≠nh h√†nh kh√°ch ƒë√≥).
    * In ra 5 d√≤ng ƒë·∫ßu c·ªßa DataFrame ƒë·ªÉ ki·ªÉm tra c·ªôt m·ªõi.

3.  **Ph√¢n t√≠ch ƒë∆°n gi·∫£n:**
    * Trong s·ªë c√°c h√†nh kh√°ch ƒëi m·ªôt m√¨nh (`FamilySize` == 1), t·ª∑ l·ªá s·ªëng s√≥t l√† bao nhi√™u?
    * Trong s·ªë c√°c h√†nh kh√°ch ƒëi c√πng gia ƒë√¨nh (`FamilySize` > 1), t·ª∑ l·ªá s·ªëng s√≥t l√† bao nhi√™u?
    * So s√°nh hai t·ª∑ l·ªá n√†y.
    * **G·ª£i √Ω:** ƒê·ªÉ t√≠nh t·ª∑ l·ªá, b·∫°n c√≥ th·ªÉ l·∫•y gi√° tr·ªã trung b√¨nh c·ªßa c·ªôt `Survived` (v√¨ `Survived` c√≥ gi√° tr·ªã 0 ho·∫∑c 1, trung b√¨nh c·ªßa n√≥ ch√≠nh l√† t·ª∑ l·ªá c√°c gi√° tr·ªã 1). V√≠ d·ª•: `df[ƒëi·ªÅu_ki·ªán]['Survived'].mean()`.