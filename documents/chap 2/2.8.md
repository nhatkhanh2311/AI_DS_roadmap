# Giai đoạn 2: Nền tảng Toán & Thống kê
## Bài 2.8 (Phiên bản làm lại): Thống kê mô tả & Trực quan hóa Dữ liệu

### **🎯 Mục tiêu bài học:**
1.  Hiểu và tính toán các đại lượng thống kê mô tả cốt lõi.
2.  Nắm vững cách đọc và phân tích các biểu đồ thống kê phổ biến nhất (Histogram, Box Plot, Scatter Plot, Heatmap).
3.  Sử dụng thư viện Seaborn để tạo ra các biểu đồ này một cách hiệu quả.

---

### **1. Thống kê mô tả - Các Con số Biết nói**

Thống kê mô tả giúp chúng ta tóm tắt và hiểu các đặc điểm chính của dữ liệu thông qua các con số.

#### **a. Thước đo Khuynh hướng Trung tâm (Giá trị "điển hình")**

* **Trung bình cộng (Mean):** Tổng các giá trị chia cho số lượng. Nhạy cảm với giá trị ngoại lai.
* **Trung vị (Median):** Giá trị nằm chính giữa của một danh sách đã sắp xếp. Không bị ảnh hưởng bởi giá trị ngoại lai.

#### **b. Thước đo Độ phân tán (Dữ liệu "trải rộng" ra sao)**

* **Phương sai (Variance):** Là "trung bình của các bình phương khoảng cách" từ mỗi điểm dữ liệu đến giá trị trung bình. Đơn vị của nó bị bình phương lên, nên khó diễn giải.
    * Công thức mẫu: $s^2 = \frac{\sum_{i=1}^{n} (x_i - \bar{x})^2}{n-1}$

* **Độ lệch chuẩn (Standard Deviation):** Là căn bậc hai của phương sai. Nó có cùng đơn vị với dữ liệu gốc và cho biết, một cách trung bình, mỗi điểm dữ liệu cách giá trị trung bình bao xa.
    * $\sigma = \sqrt{\text{Phương sai}}$

* **Tứ phân vị (Quartiles) & Khoảng Tứ phân vị (IQR):**
    * Tứ phân vị là các điểm chia dữ liệu đã sắp xếp thành 4 phần bằng nhau.
        * **Q1:** 25% dữ liệu nhỏ hơn nó.
        * **Q2:** 50% dữ liệu nhỏ hơn nó (chính là **Trung vị**).
        * **Q3:** 75% dữ liệu nhỏ hơn nó.
    * **IQR = Q3 - Q1**. Đây là khoảng chứa 50% dữ liệu ở giữa, một thước đo độ phân tán rất hữu ích vì nó không bị ảnh hưởng bởi giá trị ngoại lai.

---

### **2. Trực quan hóa với Seaborn 📊**

Bây giờ, hãy biến những con số trên thành hình ảnh. Chúng ta sẽ dùng thư viện `seaborn` (viết tắt là `sns`) và `matplotlib.pyplot` (viết tắt là `plt`).

    import pandas as pd
    import seaborn as sns
    import matplotlib.pyplot as plt
    import numpy as np

    df = pd.read_csv('titanic.csv')

---

### **3. Histogram: Khám phá Phân phối của một Biến**

* **Mục đích:** Để xem tần suất xuất hiện của các giá trị trong một biến số. Nó giúp ta thấy được "hình dạng" của dữ liệu.


    plt.figure(figsize=(10, 6)) # Tạo một khung hình mới
    sns.histplot(data=df, x='Age', bins=30, kde=True)
    plt.title('Phân phối Tuổi của Hành khách Titanic')
    plt.xlabel('Tuổi')
    plt.ylabel('Số lượng')
    plt.show()

* **Cách đọc và Phân tích:**
    * **Trục X (Hoành):** Là biến chúng ta đang khảo sát (`Age`).
    * **Trục Y (Tung):** Là số lượng (tần suất) hành khách tương ứng với mỗi khoảng tuổi.
    * **Các cột:** Mỗi cột đại diện cho một khoảng tuổi. Cột càng cao, số lượng hành khách trong khoảng tuổi đó càng nhiều.
    * **Đường cong (kde):** Là đường ước tính mật độ, giúp làm mịn và nhìn rõ hơn hình dạng tổng thể của phân phối.
    * **Insight:** Biểu đồ cho thấy phần lớn hành khách tập trung ở độ tuổi 20-40. Phân phối bị lệch về bên phải, có ít người lớn tuổi hơn.

---

### **4. Box Plot: So sánh Phân phối giữa các Nhóm**

* **Mục đích:** So sánh sự phân phối của một biến số (như Tuổi) qua các nhóm khác nhau (như Hạng vé).

* **"Giải phẫu" một Biểu đồ Hộp:** Trước khi phân tích, hãy hiểu rõ từng thành phần. 
    * **Cái Hộp (Box):** Chứa 50% dữ liệu ở giữa.
        * Cạnh dưới là **Q1**, cạnh trên là **Q3**. Đường giữa là **Q2 (Trung vị)**.
    * **Cái Râu (Whiskers):** Hai đường thẳng kéo dài từ hộp, cho thấy phạm vi của dữ liệu "thông thường". Chúng kéo dài tối đa `1.5 * IQR` từ hộp.
    * **Giá trị Ngoại lai (Outliers):** Các điểm chấm nằm **bên ngoài** hai đường râu.


    plt.figure(figsize=(10, 6))
    sns.boxplot(data=df, x='Pclass', y='Age')
    plt.title('Phân phối Tuổi theo Từng Hạng Vé')
    plt.xlabel('Hạng vé (Pclass)')
    plt.ylabel('Tuổi')
    plt.show()

* **Cách đọc và Phân tích:**
    * Chúng ta đang so sánh 3 biểu đồ hộp của 3 Hạng vé (`Pclass` 1, 2, 3).
    * **So sánh Trung vị (đường giữa hộp):** Trung vị tuổi của Hạng 1 (~38 tuổi) cao hơn đáng kể so với Hạng 2 (~29) và Hạng 3 (~24).
    * **So sánh Độ phân tán (chiều cao hộp):** Hộp của Hạng 1 cao nhất, cho thấy độ tuổi của hành khách ở hạng này đa dạng hơn.
    * **Insight:** Hành khách đi vé hạng càng cao thì có xu hướng càng lớn tuổi.

---

### **5. Scatter Plot: Tìm kiếm Mối quan hệ**

* **Mục đích:** Xem mối quan hệ giữa hai biến số liên tục.


    plt.figure(figsize=(10, 6))
    sns.scatterplot(data=df, x='Age', y='Fare', hue='Survived')
    plt.title('Mối quan hệ giữa Tuổi và Giá vé')
    plt.xlabel('Tuổi')
    plt.ylabel('Giá vé (Fare)')
    plt.show()

* **Cách đọc và Phân tích:**
    * **Mỗi điểm chấm:** Là một hành khách.
    * **Vị trí:** Vị trí của điểm chấm được xác định bởi `Tuổi` (trục X) và `Giá vé` (trục Y).
    * **Màu sắc (`hue`):** Thêm một chiều thông tin thứ ba. Ở đây, màu sắc cho biết hành khách đó `Sống sót` (Survived=1) hay `Tử vong` (Survived=0).
    * **Insight:** Không có mối quan hệ rõ ràng giữa Tuổi và Giá vé. Tuy nhiên, ở vùng giá vé cao (`Fare > 100`), các điểm màu cam (Sống sót) chiếm ưu thế áp đảo. Điều này cho thấy giá vé có liên quan mạnh mẽ đến khả năng sống sót.

---

### **6. Heatmap: Trực quan hóa Tương quan**

* **Mục đích:** Hiển thị ma trận tương quan để nhanh chóng tìm ra các cặp biến có mối quan hệ tuyến tính mạnh.


    numeric_cols = df.select_dtypes(include=np.number)
    correlation_matrix = numeric_cols.corr()

    plt.figure(figsize=(12, 8))
    sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', fmt='.2f')
    plt.title('Ma trận Tương quan giữa các Biến số')
    plt.show()

* **Cách đọc và Phân tích:**
    * **Mỗi ô:** Biểu thị hệ số tương quan giữa hai biến (từ -1 đến 1).
    * **Giá trị:**
        * Gần `1` (màu đỏ đậm): Tương quan thuận mạnh (biến này tăng thì biến kia tăng).
        * Gần `-1` (màu xanh đậm): Tương quan nghịch mạnh (biến này tăng thì biến kia giảm).
        * Gần `0` (màu nhạt): Hầu như không có tương quan tuyến tính.
    * **Insight:** Ta có thể thấy cặp `Pclass` và `Fare` có tương quan nghịch khá mạnh (-0.55), điều này hợp lý: Hạng vé càng cao (giá trị `Pclass` càng thấp, 1 < 2 < 3) thì giá vé (`Fare`) càng cao.

---

### **✍️ Bài thực hành:**

Sử dụng bộ dữ liệu `titanic` và các thư viện `pandas`, `seaborn`, `matplotlib`:

1.  **Phân tích Biến `Fare` (Giá vé):**
    * Vẽ biểu đồ **Histogram** cho cột `Fare`. Bạn có nhận xét gì về phân phối của nó không? (Nó có đối xứng không hay bị lệch?)
    * Do giá vé bị lệch nhiều, **Median** hay **Mean** sẽ là thước đo khuynh hướng trung tâm tốt hơn? Tại sao?

2.  **So sánh giữa các Giới tính:**
    * Vẽ biểu đồ **Box Plot** so sánh phân phối `Age` (Tuổi) giữa `Sex` (Giới tính) là 'male' và 'female'.
    * Dựa vào biểu đồ, bạn có nhận xét gì về sự khác biệt về tuổi tác giữa hai nhóm không?

3.  **Khám phá Tỷ lệ Sống sót:**
    * Vẽ biểu đồ **Count Plot** (`sns.countplot`) để đếm số người `Survived` (0 = Tử vong, 1 = Sống sót) theo từng `Pclass` (Hạng vé). **Gợi ý:** dùng `x='Pclass'` và `hue='Survived'`.
    * Biểu đồ này cho bạn biết điều gì về mối liên hệ giữa hạng vé và cơ hội sống sót?