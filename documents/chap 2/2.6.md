# Giai ƒëo·∫°n 2: N·ªÅn t·∫£ng To√°n & Th·ªëng k√™
## B√†i 2.6: N·ªÅn t·∫£ng X√°c su·∫•t cho Khoa h·ªçc D·ªØ li·ªáu

### **üéØ M·ª•c ti√™u b√†i h·ªçc:**
1.  N·∫Øm v·ªØng c√°c kh√°i ni·ªám x√°c su·∫•t c·ªët l√µi: **X√°c su·∫•t c√≥ ƒëi·ªÅu ki·ªán** v√† **ƒê·ªãnh l√Ω Bayes**.
2.  L√†m quen v·ªõi kh√°i ni·ªám **Bi·∫øn ng·∫´u nhi√™n** v√† m·ªôt s·ªë **Ph√¢n ph·ªëi x√°c su·∫•t** quan tr·ªçng nh·∫•t.
3.  Hi·ªÉu vai tr√≤ c·ªßa c√°c kh√°i ni·ªám n√†y trong vi·ªác x√¢y d·ª±ng c√°c m√¥ h√¨nh h·ªçc m√°y.

---

### **1. X√°c su·∫•t c√≥ ƒëi·ªÅu ki·ªán (Conditional Probability)**

ƒê√¢y l√† x√°c su·∫•t x·∫£y ra c·ªßa m·ªôt s·ª± ki·ªán A, **bi·∫øt r·∫±ng** m·ªôt s·ª± ki·ªán B kh√°c ƒë√£ x·∫£y ra.

* **K√Ω hi·ªáu:** $P(A|B)$
* **ƒê·ªçc l√†:** "X√°c su·∫•t c·ªßa A, v·ªõi ƒëi·ªÅu ki·ªán B".
* **C√¥ng th·ª©c:** $P(A|B) = \frac{P(A \cap B)}{P(B)}$
    * $P(A \cap B)$ l√† x√°c su·∫•t c·∫£ A v√† B c√πng x·∫£y ra.

**V√≠ d·ª• tr·ª±c quan:** T∆∞·ªüng t∆∞·ª£ng trong m·ªôt l·ªõp c√≥ 100 sinh vi√™n.
* C√≥ 50 sinh vi√™n h·ªçc m√¥n AI ($P(\text{AI}) = 0.5$).
* C√≥ 30 sinh vi√™n h·ªçc m√¥n DS ($P(\text{DS}) = 0.3$).
* C√≥ 20 sinh vi√™n h·ªçc c·∫£ hai m√¥n ($P(\text{AI} \cap \text{DS}) = 0.2$).

**C√¢u h·ªèi:** N·∫øu b·∫°n ch·ªçn ng·∫´u nhi√™n m·ªôt sinh vi√™n **v√† bi·∫øt r·∫±ng ng∆∞·ªùi ƒë√≥ h·ªçc AI**, x√°c su·∫•t ng∆∞·ªùi ƒë√≥ c≈©ng h·ªçc DS l√† bao nhi√™u?
ƒê√¢y ch√≠nh l√† $P(\text{DS}|\text{AI})$.
$P(\text{DS}|\text{AI}) = \frac{P(\text{AI} \cap \text{DS})}{P(\text{AI})} = \frac{0.2}{0.5} = 0.4$
ƒêi·ªÅu n√†y h·ª£p l√Ω, v√¨ trong s·ªë 50 sinh vi√™n h·ªçc AI, c√≥ 20 ng∆∞·ªùi h·ªçc DS, n√™n t·ª∑ l·ªá l√† 20/50 = 0.4.

---

### **2. ƒê·ªãnh l√Ω Bayes (Bayes' Theorem) üß†**

ƒê·ªãnh l√Ω Bayes l√† m·ªôt trong nh·ªØng c√¥ng th·ª©c quan tr·ªçng v√† m·∫°nh m·∫Ω nh·∫•t trong l√Ω thuy·∫øt x√°c su·∫•t v√† h·ªçc m√°y. N√≥ cho ph√©p ch√∫ng ta **c·∫≠p nh·∫≠t ni·ªÅm tin** v·ªÅ m·ªôt gi·∫£ thuy·∫øt khi c√≥ b·∫±ng ch·ª©ng m·ªõi.

**C√¥ng th·ª©c:**
$$ P(A|B) = \frac{P(B|A) \cdot P(A)}{P(B)} $$

* **$P(A)$ (Prior):** X√°c su·∫•t ti√™n nghi·ªám. Ni·ªÅm tin ban ƒë·∫ßu c·ªßa b·∫°n v·ªÅ A, tr∆∞·ªõc khi c√≥ b·∫±ng ch·ª©ng B.
* **$P(B|A)$ (Likelihood):** Kh·∫£ nƒÉng. X√°c su·∫•t b·∫°n th·∫•y b·∫±ng ch·ª©ng B, n·∫øu gi·∫£ thuy·∫øt A l√† ƒë√∫ng.
* **$P(B)$ (Evidence):** B·∫±ng ch·ª©ng. X√°c su·∫•t b·∫°n th·∫•y b·∫±ng ch·ª©ng B.
* **$P(A|B)$ (Posterior):** X√°c su·∫•t h·∫≠u nghi·ªám. Ni·ªÅm tin ƒë√£ ƒë∆∞·ª£c c·∫≠p nh·∫≠t c·ªßa b·∫°n v·ªÅ A, sau khi ƒë√£ th·∫•y b·∫±ng ch·ª©ng B.

**·ª®ng d·ª•ng kinh ƒëi·ªÉn: L·ªçc email Spam.**
* **A:** Email l√† SPAM.
* **B:** Email c√≥ ch·ª©a t·ª´ "khuy·∫øn m√£i".
* Ch√∫ng ta mu·ªën t√≠nh $P(\text{SPAM}|\text{"khuy·∫øn m√£i"})$.
* ƒê·ªãnh l√Ω Bayes cho ph√©p ta t√≠nh n√≥ d·ª±a tr√™n c√°c th√¥ng tin d·ªÖ thu th·∫≠p h∆°n, nh∆∞ $P(\text{"khuy·∫øn m√£i"}|\text{SPAM})$ (t·∫ßn su·∫•t t·ª´ "khuy·∫øn m√£i" xu·∫•t hi·ªán trong c√°c email spam ƒë√£ bi·∫øt). Thu·∫≠t to√°n **Naive Bayes Classifier** (ch√∫ng ta s·∫Ω h·ªçc ·ªü Giai ƒëo·∫°n 5) d·ª±a ho√†n to√†n tr√™n ƒë·ªãnh l√Ω n√†y.

---

### **3. Bi·∫øn ng·∫´u nhi√™n & Ph√¢n ph·ªëi X√°c su·∫•t**

* **Bi·∫øn ng·∫´u nhi√™n (Random Variable):** L√† m·ªôt bi·∫øn s·ªë m√† gi√° tr·ªã c·ªßa n√≥ l√† m·ªôt k·∫øt qu·∫£ s·ªë c·ªßa m·ªôt hi·ªán t∆∞·ª£ng ng·∫´u nhi√™n. V√≠ d·ª•: s·ªë m·∫∑t ng·ª≠a khi tung m·ªôt ƒë·ªìng xu 3 l·∫ßn.
* **Ph√¢n ph·ªëi X√°c su·∫•t (Probability Distribution):** L√† m·ªôt h√†m m√¥ t·∫£ x√°c su·∫•t x·∫£y ra c·ªßa t·∫•t c·∫£ c√°c k·∫øt qu·∫£ c√≥ th·ªÉ c√≥ c·ªßa m·ªôt bi·∫øn ng·∫´u nhi√™n. 

[Image of a normal distribution bell curve]


#### **C√°c ph√¢n ph·ªëi quan tr·ªçng:**

* **Ph√¢n ph·ªëi Bernoulli:** M√¥ t·∫£ m·ªôt ph√©p th·ª≠ ch·ªâ c√≥ 2 k·∫øt qu·∫£ (th√†nh c√¥ng/th·∫•t b·∫°i). V√≠ d·ª•: tung ƒë·ªìng xu 1 l·∫ßn.
* **Ph√¢n ph·ªëi Binomial (Nh·ªã th·ª©c):** M√¥ t·∫£ s·ªë l·∫ßn th√†nh c√¥ng trong `n` ph√©p th·ª≠ Bernoulli. V√≠ d·ª•: s·ªë m·∫∑t ng·ª≠a khi tung ƒë·ªìng xu 10 l·∫ßn.
* **Ph√¢n ph·ªëi Normal (Ph√¢n ph·ªëi Chu·∫©n / Gaussian):** Ph√¢n ph·ªëi h√¨nh chu√¥ng c·ª±c k·ª≥ ph·ªï bi·∫øn. R·∫•t nhi·ªÅu hi·ªán t∆∞·ª£ng trong t·ª± nhi√™n (chi·ªÅu cao con ng∆∞·ªùi, sai s·ªë ƒëo l∆∞·ªùng) tu√¢n theo ph√¢n ph·ªëi n√†y. N√≥ l√† n·ªÅn t·∫£ng c·ªßa v√¥ s·ªë m√¥ h√¨nh th·ªëng k√™.

#### **L√†m vi·ªác v·ªõi Ph√¢n ph·ªëi trong SciPy**
Th∆∞ vi·ªán `SciPy` (Scientific Python) cung c·∫•p c√°c c√¥ng c·ª• m·∫°nh m·∫Ω ƒë·ªÉ l√†m vi·ªác v·ªõi c√°c ph√¢n ph·ªëi x√°c su·∫•t.

    from scipy.stats import norm
    import numpy as np

    # Gi·∫£ s·ª≠ chi·ªÅu cao c·ªßa ng∆∞·ªùi Vi·ªát Nam tu√¢n theo ph√¢n ph·ªëi chu·∫©n
    # v·ªõi trung b√¨nh (mean) l√† 165 cm v√† ƒë·ªô l·ªách chu·∫©n (std dev) l√† 5 cm.
    
    # 1. T√≠nh x√°c su·∫•t m·ªôt ng∆∞·ªùi c√≥ chi·ªÅu cao d∆∞·ªõi 160 cm.
    # ƒê√¢y l√† gi√° tr·ªã c·ªßa H√†m ph√¢n ph·ªëi t√≠ch l≈©y (CDF) t·∫°i ƒëi·ªÉm 160.
    prob_less_than_160 = norm.cdf(160, loc=165, scale=5)
    print(f"X√°c su·∫•t cao d∆∞·ªõi 160cm: {prob_less_than_160:.2f}") # ~0.16

    # 2. T√≠nh x√°c su·∫•t m·ªôt ng∆∞·ªùi cao ch√≠nh x√°c 175 cm (v·ªÅ m·∫∑t l√Ω thuy·∫øt l√† 0).
    # Thay v√†o ƒë√≥, ta t√≠nh H√†m m·∫≠t ƒë·ªô x√°c su·∫•t (PDF) t·∫°i ƒëi·ªÉm ƒë√≥.
    # Con s·ªë n√†y th·ªÉ hi·ªán "m·∫≠t ƒë·ªô" kh·∫£ nƒÉng x·∫£y ra xung quanh ƒëi·ªÉm ƒë√≥.
    density_at_175 = norm.pdf(175, loc=165, scale=5)
    print(f"M·∫≠t ƒë·ªô x√°c su·∫•t t·∫°i 175cm: {density_at_175:.4f}")

    # 3. T·∫°o ra 5 m·∫´u chi·ªÅu cao ng·∫´u nhi√™n t·ª´ ph√¢n ph·ªëi n√†y.
    random_heights = norm.rvs(loc=165, scale=5, size=5)
    print(f"5 m·∫´u chi·ªÅu cao ng·∫´u nhi√™n: {np.round(random_heights, 2)}")

---

### **‚úçÔ∏è B√†i th·ª±c h√†nh:**

1.  **B√†i to√°n Bayes v·ªõi x√©t nghi·ªám y t·∫ø:**
    * M·ªôt lo·∫°i b·ªánh c√≥ t·ª∑ l·ªá m·∫Øc l√† **1%** trong d√¢n s·ªë ($P(\text{B·ªánh}) = 0.01$).
    * M·ªôt x√©t nghi·ªám ƒë∆∞·ª£c t·∫°o ra ƒë·ªÉ ph√°t hi·ªán b·ªánh n√†y.
        * N·∫øu m·ªôt ng∆∞·ªùi c√≥ b·ªánh, x√©t nghi·ªám cho k·∫øt qu·∫£ d∆∞∆°ng t√≠nh v·ªõi x√°c su·∫•t **99%** ($P(\text{D∆∞∆°ng t√≠nh}|\text{B·ªánh}) = 0.99$).
        * N·∫øu m·ªôt ng∆∞·ªùi kh√¥ng c√≥ b·ªánh, x√©t nghi·ªám v·∫´n c√≥ th·ªÉ cho k·∫øt qu·∫£ d∆∞∆°ng t√≠nh (d∆∞∆°ng t√≠nh gi·∫£) v·ªõi x√°c su·∫•t **5%** ($P(\text{D∆∞∆°ng t√≠nh}|\text{Kh√¥ng b·ªánh}) = 0.05$).
    * **C√¢u h·ªèi:** Gi·∫£ s·ª≠ b·∫°n nh·∫≠n ƒë∆∞·ª£c k·∫øt qu·∫£ x√©t nghi·ªám **d∆∞∆°ng t√≠nh**. X√°c su·∫•t b·∫°n th·ª±c s·ª± m·∫Øc b·ªánh l√† bao nhi√™u, t·ª©c l√† $P(\text{B·ªánh}|\text{D∆∞∆°ng t√≠nh})$?
    * **G·ª£i √Ω:** S·ª≠ d·ª•ng ƒê·ªãnh l√Ω Bayes. B·∫°n s·∫Ω c·∫ßn t√≠nh $P(\text{D∆∞∆°ng t√≠nh})$ tr∆∞·ªõc.
      $P(\text{D∆∞∆°ng t√≠nh}) = P(\text{D∆∞∆°ng t√≠nh}|\text{B·ªánh})P(\text{B·ªánh}) + P(\text{D∆∞∆°ng t√≠nh}|\text{Kh√¥ng b·ªánh})P(\text{Kh√¥ng b·ªánh})$

2.  **M√¥ ph·ªèng tung x√∫c x·∫Øc:**
    * M·ªôt con x√∫c x·∫Øc c√¢n ƒë·ªëi c√≥ 6 m·∫∑t. Ph√¢n ph·ªëi x√°c su·∫•t cho m·ªói m·∫∑t l√† Ph√¢n ph·ªëi R·ªùi r·∫°c ƒê·ªÅu (Discrete Uniform).
    * S·ª≠ d·ª•ng th∆∞ vi·ªán `numpy.random` ƒë·ªÉ m√¥ ph·ªèng l·∫°i vi·ªác tung m·ªôt con x√∫c x·∫Øc 1000 l·∫ßn.
    * ƒê·∫øm s·ªë l·∫ßn xu·∫•t hi·ªán c·ªßa m·ªói m·∫∑t (1, 2, 3, 4, 5, 6) v√† xem ch√∫ng c√≥ x·∫•p x·ªâ b·∫±ng nhau kh√¥ng.
    * **G·ª£i √Ω:** D√πng `np.random.randint(1, 7, size=1000)` ƒë·ªÉ t·∫°o ra 1000 l·∫ßn tung. D√πng `np.unique(..., return_counts=True)` ƒë·ªÉ ƒë·∫øm k·∫øt qu·∫£.